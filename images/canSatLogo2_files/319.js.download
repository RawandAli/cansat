(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[319,433,655],{1931:function(e,t,n){"use strict";var r=n(848);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},1943:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemTaskObserver",function(){return c});n.d(t,"resourceKey",function(){return h});var r=n(0),i=n(1852),s=n(1893);n.d(t,"Task",function(){return s.e});var o=n(1895),u=n(1875),a=n(1154);n.d(t,"Graft",function(){return a});var f=n(10),l=n(149),c=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(u.t):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,s=n;i<s.length;i++){var u=s[i],f=t[u],l=new o.e(u),c=this._getStoreItem(u);if(c){c.UNSAFE_parent;var h=Object(r.__rest)(c,["UNSAFE_parent"]);Object(a.default)(l,h)}Object(a.default)(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];Object(a.default)(l,v)}e[u]=l}for(var m=0,g=n;m<g.length;m++){var y=(l=e[u=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new o.e(y);e[y]=b;l.UNSAFE_parent=b}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var w=0,E=n;w<E.length;w++){u=E[w];delete(f=t[u]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemsStore:u.t});return t})(i.n),h=new f.t({name:"ItemTaskObserver",factory:new l.r(c)});t.default=c},2007:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});var r,i=n(162),s=n(843);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function o(e,t){var n;switch(e.size){case r.Large:n=3;break;case r.Medium:n=2;break;default:n=1}return Object(s.getUserPhotoUrl)(e.userLoginName,n,t)}function u(e,t,n){var r=Object(s.getUserPhotoUrl)(t,void 0,n);if(!e||!r||0===r.indexOf("http"))return r;try{return new i.e(e).authority+r}catch(e){return r}}},2008:function(e,t,n){"use strict";var r=n(0),i=n(1852),s=n(624),o=n(55),u=n(164),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,void 0,n)||this;r._pageContext=t||r.resources.consume(o.h);var i=null==n?void 0:n.dataRequestorType;r._makeDataRequestor=i?function(e){return new i(e)}:function(e){return new s.e(e,{pageContext:r._pageContext})};r.dataRequestor=r._makeDataRequestor({qosName:r.getDataSourceName()});return r}t.prototype.getDataSourceName=function(){return"DataSource"};t.prototype.updateContext=function(e){u.e(this._pageContext,e);this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{dataRequestorType:s.n});return t})(i.n);t.e=a},2098:function(e,t,n){"use strict";n.r(t);var r=n(2062),i=n(78),s=n(81),o=n(171),u=(function(){function e(){}e.getFilterList=function(e,t,n,i){return o.default.getFilterList(e,t,n,i,r.t)};e.clearFilterInfo=function(t,n){n=n||0;for(var r=e.getFilterList(t),i=n;i<r.length;i++){var s=r[i];t=o.default.addFilterInfo(t,s.fieldName,null,!0)}return t};e.getInplviewHash=function(e,t){var n="#InplviewHash"+(e=s.e.normalizeLower(e||"",!1))+"=";t&&(n+=Object.keys(t).map(function(e){var n=i.e.encodeURIComponent(t[e]);return i.e.encodeURIComponent((e+"="+n).replace(/-/g,"--"))}).join("-"));return n};return e})();t.default=u},2117:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(227),i=n(585);function s(e,t){var n=Object(r.e)(e).id;t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0);return n}function o(e,t){var n=e;0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t}));return n}},2158:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return x});var r=n(0),i=n(232),s=n(2008),o=n(16),u=n(1156),a=n(308),f=n(851);var l=n(32),c=n(2098),h=n(75),p=n(119),d=n(41),v=n(149),m=n(55),g=n(78),y=n(162),b=n(350),w=n(163),E=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(","),S=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext,n)||this;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._identityDataSource=n.identityDataSource;return r}t.prototype.getView=function(e,t){var n=this;return this.dataRequestor.getData({url:this._getViewApiUrl(e,t).oDataParameter("$select",E).toString(),parseResponse:function(e){var t=JSON.parse(e);return n._viewFromServerView(t.d,!0)},qosName:"GetView",method:"GET"})};t.prototype.getViews=function(e,t){var n=this;return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("Views").oDataParameter("$select",E).toString(),parseResponse:function(e){return JSON.parse(e).d.results.map(function(e){return n._viewFromServerView(e,!1,t)}).filter(function(e){return!!e})},qosName:"GetViews",method:"GET"})};t.prototype.createView=function(e,t){var n,r=this,i=e.viewParams,s=e.sourceView,o=i.useFiltersInViewXml?void 0:this._getFilterParams(i),u=!1,a=!1,f=!1,l=!1;return p.e.instrumentPromise({name:"ListDataSource.CreateView"},function(){return r._addView(e,t).then(function(e){if(!e)throw new Error("No view returned by /Views/Add");n=e;u=!0;if(o){l=!0;return r._saveLegacyFilters(n,o,t)}}).then(function(){a=!0;if(s.scope){l=!0;return r.modifyView({id:n.id,scope:s.scope},t)}}).then(function(){f=!0;return l?r.getView({id:n.id},t):n}).then(null,function(e){u&&o&&!a&&r.deleteView(n.id,t);return e})},null,function(e){return h.n.isCanceled(e)?{resultType:d.e.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.e.Failure,resultCode:u?a?f?l?"SecondGetView":"Unknown":"SaveScope":"SaveFilters":"CreateView",error:e}})};t.prototype.saveView=function(e,t,n){var r=this,i=e.sourceView,s=e.viewParams,o=e.updateViewXml,u=s.useFiltersInViewXml?void 0:this._getFilterParams(s),a=!1,f=!1;return p.e.instrumentPromise({name:"ListDataSource.SaveView"},function(){return r._setViewXml(e,t,n).then(function(){a=!0;if(u)return r._saveLegacyFilters(i,u,t)}).then(function(){f=!0;return o?r.getView({id:i.id},t):null}).then(function(e){o&&e&&(i.baseViewXml=e.baseViewXml);return{}})},null,function(e){return h.n.isCanceled(e)?{resultType:d.e.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.e.Failure,resultCode:a?f?"UpdateView":"SaveAsNewView":"SetViewXml",error:e}}).then(function(){})};t.prototype.deleteView=function(e,t){return this.dataRequestor.getData({url:this._getViewApiUrl({id:e},t).toString(),qosName:"DeleteView",method:"POST",additionalHeaders:{"X-HTTP-Method":"DELETE"}})};t.prototype.modifyView=function(e,t){var n={__metadata:{type:"SP.View"},DefaultView:e.isDefault,Title:e.title};"number"==typeof e.scope&&(n.Scope=e.scope);return this.dataRequestor.getData({url:this._getViewApiUrl({id:e.id},t).toString(),parseResponse:function(e){return e},qosName:"ModifyView",additionalPostData:JSON.stringify(n),method:"PATCH",additionalHeaders:{"X-HTTP-Method":"PATCH"}})};t.prototype.createMappedView=function(e,t,n){var r=this,i={appViewCreationInfo:{Title:e.title,AppId:e.appId,IsPrivate:e.isPrivate},visualizationTarget:t};return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("CreateMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"CreateMappedView",additionalPostData:JSON.stringify(i),method:"POST"})};t.prototype.getMappedApp=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("GetMappedApp").oDataParameter("$expand","AppMappedViews").toString(),parseResponse:function(e){return r.appSynchronizationResultFromMappedApps(e,!0)},qosName:"GetMappedApp",additionalPostData:JSON.stringify({appId:e,visualizationAppTarget:t}),method:"POST"})};t.prototype.getMappedApps=function(e,t){var n=this;return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("GetMappedApps").oDataParameter("$expand","AppMappedViews").toString(),parseResponse:function(e){return n.appSynchronizationResultFromMappedApps(e,!1)},qosName:"GetMappedApps",additionalPostData:JSON.stringify({visualizationAppTarget:e}),method:"POST"})};t.prototype.publishMappedView=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("PublishMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"PublishMappedView",additionalPostData:JSON.stringify({appId:e,visualizationTarget:t}),method:"POST"})};t.prototype.unpublishMappedView=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("UnpublishMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"UnpublishMappedView",additionalPostData:JSON.stringify({appId:e,visualizationTarget:t}),method:"POST"})};t.prototype.getFlowTemplates=function(e,t){var n=t?JSON.stringify({category:t}):void 0;return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("SyncFlowTemplates").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowTemplates",additionalPostData:n,method:"POST",noRedirect:!0})};t.prototype.getFlowInstance=function(e,t){return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("SyncFlowInstance").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowInstance",additionalPostData:JSON.stringify({flowID:e}),method:"POST",noRedirect:!0})};t.prototype.getFlowInstances=function(e){return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("SyncFlowInstances").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowInstances",method:"POST",noRedirect:!0})};t.prototype.getFlowCallbackUrl=function(e,t){return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("SyncFlowCallbackUrl").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowCallbackUrl",additionalPostData:JSON.stringify({flowId:e}),method:"POST",noRedirect:!0})};t.prototype.ensureSignoffStatusField=function(e){return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("EnsureSignoffStatusField").toString(),parseResponse:function(e){return JSON.parse(e).d},qosName:"EnsureSignoffStatusField",method:"POST"})};t.prototype.modifyFieldProperties=function(e,t,n,i,s){var o=this,u=e.id,a=e.displayName,f=e.fieldDescription,l=e.showInFiltersPane,c=new y.e(s).authority,p=function(e,t){var c={__metadata:{type:"SP.Field"},Title:a,SchemaXml:f,ShowInFiltersPane:l},h=Object(r.__assign)({"X-HTTP-Method":"MERGE"},i),p=o.getListApiUrl(e).method("Fields",u).toString();if(n){var d=o._apiUrlHelper;s&&(d=new w.t({webAbsoluteUrl:s}));p=d.build().segment("web").methodWithAliases("GetListUsingPath",{DecodedUrl:e}).method("Fields",u).toString()}return o.dataRequestor.getData({url:p,qosName:"ModifyFieldProperties",additionalPostData:JSON.stringify(c),method:"POST",additionalHeaders:h,authToken:t})};return s&&new y.e(this._pageContext.webAbsoluteUrl).authority!==c?h.n.resolve(this._identityDataSource.getSharePointToken(c).then(function(e){var n=e&&e.accessToken||"";return p(t,n)})):p(t)};t.prototype.setContentApproval=function(e,t){var n={__metadata:{type:"SP.List"},EnableModeration:e};return this.dataRequestor.getData({url:this.getListApiUrl(t).toString(),qosName:"SetContentApproval",additionalPostData:JSON.stringify(n),method:"POST",additionalHeaders:{"IF-MATCH":"*","X-HTTP-Method":"MERGE"}})};t.prototype.setListPropertiesAsString=function(e,t,n){var i=this,s=n,o=new y.e(e).authority,u=function(n,s){var o=Object(r.__assign)({__metadata:{type:"SP.List"}},t),u=i._itemUrlHelper.getUrlParts({path:e,listUrl:e}),a=n+"/_api/web/GetList(@a1)?@a1='"+g.e.encodeRestUriStringToken(""+u.serverRelativeListUrl)+"'";return i.dataRequestor.getData({url:a,parseResponse:function(e){return e},qosName:"setListPropertiesAsString",additionalPostData:JSON.stringify(o),method:"POST",additionalHeaders:{"IF-MATCH":"*","X-HTTP-Method":"MERGE"},authToken:s})},a=function(t){return s?u(s,t):h.n.resolve(i._getWebUrlPromise(e,t).then(function(e){return u(e,t)}))};return new y.e(this._pageContext.webAbsoluteUrl).authority!==o?h.n.resolve(this._identityDataSource.getSharePointToken(o).then(function(e){var t=e&&e.accessToken||"";return a(t)})):a()};t.prototype.appSynchronizationResultFromMappedApps=function(e,t){var n=this,r=JSON.parse(e),i=r&&r.d;if(!i)return null;var s=[];i.AppMappedViews&&i.AppMappedViews.results&&(s=i.AppMappedViews.results.map(function(e){return n._viewFromServerView(e)}));var o=null;try{o=JSON.parse(i.SynchronizationData);(t?o&&o.name&&o.properties:o&&o.value)||(o={id:null,name:null,properties:{createdBy:null,createdTime:null,displayName:null,isPrivate:!0,permissions:null}});for(var u=t?[o]:o.value,a=0,f=u;a<f.length;a++){var l=f[a].properties;l.isPrivate=!l.permissions||!l.permissions.some(function(e){return e.properties&&e.properties.principal&&"Tenant"===e.properties.principal.type})}}catch(e){}return{appMappedViews:s,synchronizationData:r.d.SynchronizationData,synchronizationDataObject:o,synchronizationStatus:r.d.SynchronizationStatus}};t.prototype.getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e,listUrl:e});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.getDataSourceName=function(){return"ListDataSource"};t.prototype._addView=function(e,t){var n=e.title,r=e.sourceView,s=e.viewParams,o=e.isPublic,u=this._combineViewParamsAndXml(r,s);u.prepareForSaving();return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("Views").segment("Add").toString(),parseResponse:function(e){var t=JSON.parse(e);return new i.e(t.d)},qosName:"AddView",additionalPostData:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:r.getEffectiveFieldNames()},Query:u.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!o,RowLimit:r.rowLimit}})})};t.prototype._combineViewParamsAndXml=function(e,t){var n=new i.e(e.getEffectiveViewXml());if(t){if(t.sortField){var r={fieldName:t.sortField,isAscending:"false"!==t.isAscending};n.updateSort(r,{overwriteAll:!0})}t.groupBy&&n.updateGroupBy({group1:{fieldName:t.groupBy,isAscending:!0}});var s=localStorage.getItem("SPColumnSize-Unsaved-"+e.id);if(s){n.updateColumnWidths(JSON.parse(s));localStorage.removeItem("SPColumnSize-Unsaved-"+e.id)}var o=e.customFormatter;n.updateCustomFormatter(o)}return n};t.prototype._getFilterParams=function(e){for(var t={},n=!1,r=0,i=Object.keys(e||{});r<i.length;r++){var s=i[r];if(f.e.test(s)){n=!0;t[s]=e[s]}}return n?t:void 0};t.prototype._saveLegacyFilters=function(e,t,n){return this.dataRequestor.getData({url:this.getListApiUrl(n).methodWithAliases("SaveAsNewView",{oldName:e.id,newName:e.title,privateView:!!e.isPersonal,uri:this._pageContext.webAbsoluteUrl+c.default.getInplviewHash(e.id,t)}).toString(),parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.SaveAsNewView},qosName:"SaveViewFilters"})};t.prototype._setViewXml=function(e,t,n){var r=e.sourceView,i=e.viewParams,s=this._combineViewParamsAndXml(r,i);s.prepareForSaving();return r.isDirty()||s.isDirty()?this.dataRequestor.getData({url:this._getViewApiUrl({id:r.id},t,n).method("SetViewXml").toString(),qosName:"UpdateView",additionalPostData:JSON.stringify({viewXml:s.getEffectiveViewXml()})}):h.n.wrap()};t.prototype._getViewApiUrl=function(e,t,n){return n?this.getListApiUrl(t).segment("DefaultView"):(function(e){return e&&!!e.id})(e)?this.getListApiUrl(t).method("Views",e.id):(function(e){return e&&!!e.url})(e)?this._apiUrlHelper.build().webByUrl({path:t,listUrl:t}).method("GetViewFromUrl",e.url):this.getListApiUrl(t).method("Views",e.title)};t.prototype._viewFromServerView=function(e,t,n){if(e.ViewType&&e.Id){var r=Object(l.isFeatureEnabled)(l.PowerApps)&&i.e.isAppView(e),s=e.Hidden&&!r,u=n===o.n.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!s&&!u){var a=new i.e(e);if(a.viewType)return a}}return null};t.prototype._getWebUrlPromise=function(e,t){return this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(e),parseResponse:function(e){return JSON.parse(e).d.GetContextWebInformation.WebFullUrl},qosName:"GetContextInfoInListDataSource",method:"POST",authToken:t})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.e.dependencies),{pageContext:m.h,apiUrlHelper:u.e,itemUrlHelper:a.o,identityDataSource:b.t});return t})(s.e),x=(t.default=S,Object(v.s)("ListDataSource",S))},2305:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(1153),s=n(78),o=n(36),u=n(150),a=n(626),f=n(335),l=n(2117),c=n(50).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new u.e({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new a.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var i,u,a=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});u=c?this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetListUsingPath",{DecodedUrl:a.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&"f9ebc8b2-a976-48f0-a8fa-0846164c0466"!==n&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:s.e.encodeURIComponent(this._folderPath)}));r&&r===o.e.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(f.getFilterParams)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(u=u.rawParameter(l)).toString()};return t})(i.t)},2308:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(r||(r={}));t.t=r},2341:function(e,t,n){"use strict";n.r(t);n.d(t,"previewImageUrl",function(){return i});n.d(t,"previewImageUrlFromProps",function(){return s});n.d(t,"previewImageUrlFromUrl",function(){return o});var r=n(1931);function i(e,t,n,r){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,u=e.WebId||e.webId||n.webId,a=e.UniqueId||e.UniqueID||e.uniqueId,f=e.Url||e.url||e.Path;return a&&i&&u&&!r?s(i,u,a,t,n):o(f,t,n)}}function s(e,t,n,r,i){if(i.isSPO){var s;n&&(s=u(function(s){var o=s?"":"&resolution=Width1024";return r+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o}));return s}}function o(e,t,n){if(n.isSPO){var r;e&&(r=u(function(r){var i=r?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i}));return r}}function u(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===r.t.name),width:0,height:0}}}}},2377:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},2461:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"n",function(){return f});n.d(t,"i",function(){return l});n.d(t,"s",function(){return c});var r=n(2037),i=n(2007),s=n(18);function o(e){return e?s.format(r.O,e):""}function u(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function a(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.t)({userLoginName:t.email})}}function f(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function l(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}function c(e){return e&&"0x0120"===e.slice(0,6)}},2472:function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n("knockout-lib"),s=n(36),o=n(378),u=n(55),a=n(107),f=n(184),l=n(1229);function c(e){var t=e.listSchema,n=e.resources,r=e.groupSchema,i=e.hasFixedSchema,s=e.listContext,c=e.getItemContext,h=e.sortFallback,d=n.consume(o.p.optional),v=n.consume(f.e).isMobile&&n.consume(o.P.optional);s||(s=n.consume(u.o));var m={hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:v,disableShareHeroCommand:d},g=l.e.buildSchema(t,s,m,r,c),y=n.consume(u.h),b=Number(y.webTemplate)===a.t.mySite;return g.filter(function(e){return!b||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){e.groupable=!b&&e.groupable;if(h.sortField===e.internalName&&h.sortDirection){e.isSorted=!0;e.isAscending="ascending"===h.sortDirection}return p(e,s)})}var h=(function(){function e(){}e.getCustomColumns=function(e,t,n){var r=this,i=this._convertToSPColumn(e),s=t.map(function(e){return e.map(function(e){return r._convertToSPColumn(e)})}),o=n.map(function(e){return r._convertToSPColumn(e)});return l.e.getCustomColumns(i,s,o).map(function(e){return p(e)})};e.getMappedColumnType=function(e){return l.e.getMappedColumnType(e)};e.getIconColumnWidth=function(e){return e.consume(f.e).isMobile&&e.consume(o.P.optional)?48:16};e.getIconColumnMinWidth=function(e){return e.consume(f.e).isMobile&&e.consume(o.P.optional)?48:16};e.fillColumnDefinitionDefaults=function(e,t,n){void 0===t&&(t={});void 0===n&&(n={});var o=t.isCollapsible,u=void 0===o||o;return e.map(function(e,o){var a=e.isIcon,f=void 0!==a&&a,l=e.sortable,c=void 0===l?!!t.sortable:l,h=e.resizable,p=void 0===h?!!t.resizable:h,d=e.isCollapsable,v=void 0===d?u:d,m=e.fieldType,g=void 0===m?s.e.Text:m,y=e.name,b=e.getValue,w=e.key,E=e.width,S=!!n.sortField&&n.sortField===e.internalName,x=!!n.groupBy&&n.groupBy===e.internalName;return Object(r.__assign)(Object(r.__assign)({},e),{key:w,name:y,width:E,index:o,fieldType:g,isCollapsable:v,isIcon:f,isVisible:!0,isVisibleMobile:!0,isGrouped:x,sortable:c,isSorted:S,isAscending:S&&n.isAscending,filterable:!1,isFocused:i.observable(!1),getValue:b,resizable:p})})};e._convertToSPColumn=function(e){var t=this;return Object(r.__assign)(Object(r.__assign)({},e),{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})};return e})();t.e=h;function p(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{key:d(e.key),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:i.observable(e.isFiltered),isMenuOpen:i.observable(!1),isFocused:i.observable(!1),customWidth:i.observable(0),filterValues:i.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return p(e,t)}):void 0})}function d(e){var t;switch(e){case"FileSizeDisplay":t="size";break;default:t=e}return t}},2612:function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function s(e){return!!e&&i[e.toLowerCase()]}function o(e){return r.indexOf(e)>=0}},2930:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(10).t)("vroom.dataContext")},3096:function(e,t,n){"use strict";n.d(t,"e",function(){return Q});var r=n(0),i=n(1852),s=n(728),o=n(2341),u=n(26),a=n(76),f=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],l=n(844),c=n(449),h=n(1971),p=n(10),d=n(149),v=new p.t({name:"ListItemTrendingStatusProcessor.key",loader:new d.t(function(){return n.ee([548],4514).then(function(e){return e.resourceKey})})}),m=n(216),g=n(724),y=n(1133),b=n(2609),w=n(2071),E=n(2308),S=n(32),x=n(1967),T=n(2461),N=n(78),C=n(81),k=n(16),L=n(82),A=n(2612),O=n(55),M=n(2930),_=n(112),D=n(1893),P=n(1154),H=n(308),B=n(1200),j=n(636),F=n(164),I=n(1813),q=n(1178),R=n(83),U=n(1199),z=n(2377);function W(e){var t={};t.isCommentDisabled=(function(e){if(void 0===e||null==e)return!0;return(1&e)>0})(e);return t}var X=n(30),V=n(1065),$=!n(15).e.isActivated("D37CEDFE-59E8-4BE8-BC71-8553A7CA6D58","11/12/2021","Use pageContext corresponding to item to contruct getpreview thumbnail urls"),J=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._listContext=n.listContext;r._navigation=n.navigation;r._microServiceDataSource=n.microServiceDataSource;r._vroomUrlHelper=n.vroomUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._vroomDataContext=n.vroomDataContext;r._shortcutLinkDataSource=n.shortcutLinkDataSource;r._allowWrsVisio=!1;r._htmlDecodeDiv=document.createElement("textarea");return r}t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){R.e.log(e,"ListItemBuilder.getItemResult");throw e}};t.prototype._getItemResult=function(e){var t,n,i,f,p,d=e.itemFromServer;if(!d)return null;var b,L=e.microServiceDataSource||this._microServiceDataSource,O=this._urlDataSource,M=e.requestKey,_=e.parentItemKey,H=e.queryType,B=void 0===H?O.getQueryType():H,j=e.groupBy,R=e.itemGroups,U=e.contentTypes,V=e.supportsNestedGroups,$=e.isItemDataOnly,J=e.listTemplateType,Q=void 0===J?this._listContext.listTemplateType:J,G=e.observer,Y=e.isMetaDataSearch,Z=O.getKeyParams(M),ee=this._itemUrlHelper.getUrlParts({path:d.id||d.FileRef||d.ServerRelativeUrl,listUrl:Z.listurl});b=((t={}).id=ee.serverRelativeItemUrl,t.listurl=ee.normalizedListUrl,t);var te=d.File_x0020_Type,ne=te?"."+te:"",re=this._parseMediaServiceMetadata(d.MediaServiceFastMetadata),ie=this._parseMediaServiceMetadata(d.MediaServiceMetadata),se=this._getItemType({itemFromServer:d,listTemplateType:Q,microServiceDataSource:L,mediaServiceFastMetadata:re});if(se===m.e.Folder){var oe=Z.id===b.id,ue=O.getItemTypeFilter(Z),ae={};if(oe)ae=((n={}).view=Z.view,n.q=Z.q,n.typeFilters=Z.typeFilters,n);else{B!==u.e.Search&&(ae=((i={}).view=B,i));ue&&F.e(ae,O.saveItemTypeFilter(ue))}F.e(b,ae);Y&&F.e(b,((f={}).searchid=Z.searchid,f))}var fe=O.getKey(b),le={key:fe,extension:ne},ce=d.id||d.FileRef;le.id=ce;var he,pe,de=E.t.fromHexString(d.PermMask),ve=X.e.hasPermission(de,X.e.openItems),me=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!ve,ge=d[".spItemUrl"];if(ge){var ye=this._vroomUrlHelper.getUrlParts(ge);he=ye.itemId;pe=ye.driveId}else he=d["name.FileSystemItemId"]||(d.isRootFolder?"root":void 0);this._vroomDataContext&&he&&this._vroomDataContext.setFileSystemIdMapping(he,ce);var be=d[".etag"];be&&(le.eTag=be);le.itemId=P.optional(he);var we=Q===k.t.mySiteDocumentLibrary;le.graph=P.optional(he&&{itemId:he,driveId:pe,driveType:Q?we?"business":"documentLibrary":void 0});var Ee=Number(d._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(Ee=Number(d.ID)%6);le.policyTip=P.optional(Ee);var Se=Object(A.t)(ne);(Se||".ai"===ne||".eps"===ne||".psd"===ne)&&L.getThumbnail({fileExtension:ne,item:d,itemKey:fe,mediaServiceMetadata:re})&&(se=m.e.Media);if(z.t(ne))le.htmlConversion={};else if(z.e(ne)){if(xe=L.getHtmlConversionUrl({fileExtension:ne,item:d,mediaServiceMetadata:re})){se=m.e.Media;le.htmlConversion={url:xe+"&inlineImages=true"}}}if(Object(S.isFeatureEnabled)(S.EnableZipFilePreviewing)&&(".zip"===ne||".rar"===ne)){var xe=L.getZipMetaDataUrl({fileExtension:ne,item:d,mediaServiceMetadata:re}),Te=L.getDownloadZipContentsUrl(d);if(xe&&Te){se=m.e.Media;le.zip={zipMetaDataUrl:xe,downloadZipContentsUrl:Te}}}var Ne,Ce,ke,Le,Ae,Oe,Me={},_e=L.getDownloadAsZipUrl(d),De=Object(S.isFeatureEnabled)(S.EnableOpenInImmersiveReader)&&L.getImmersiveReaderUrl({fileExtension:ne,item:d});_e&&(Me[s.t.downloadAsZip]=_e);De&&(Me[s.t.immersiveReaderUrl]=De);ge&&(Me[s.t.itemUrl]=ge);var Pe=this._listContext,He=Number(d.File_x0020_Size)||Number(d.FileSizeDisplay)||void 0,Be=re&&re.video,je=".ts"===ne&&He<1<<19&&!Be;je&&(se=m.e.File);var Fe=re&&re.media,Ie=ee.fullItemUrl,qe=Ie?c.e(Ie):void 0;if(se===m.e.Folder)Ne=d.ProgId&&"sharepoint.documentset"===d.ProgId.toLowerCase();else if(se!==m.e.Media&&!re||Object(k.o)(Q))se===m.e.File&&Pe&&void 0!==Pe.isDocLib&&!Pe.isDocLib&&(Ce={});else{var Re=l.t(ne),Ue=re&&re.photo||(Se||"photo"===Re?{}:void 0),ze=Be||("video"===Re?{}:void 0),We=re&&re.audio||("audio"===Re?{}:void 0);if(Ue){ke={originalUrl:P.optional("photo"===Re?qe:void 0),width:Ue.width||0,height:Ue.height||0};Object(S.isFeatureEnabled)(S.Image360Viewer)&&he&&(Le=this._getImage360(d,re,Ue,ie))}ze&&(Ae={fourCC:P.optional(ze.fourCC||(".mp4"===ne.toLowerCase()?"H264":void 0)),bitrate:P.optional(ze.encodingBitrate),width:ze.frameWidth||0,height:ze.frameHeight||0,duration:K(Fe&&Fe.duration),audioFormat:P.optional(We&&We.format),manifestMetadata:ze.manifestMetadata,altManifestMetadata:ze.altManifestMetadata});We&&(Oe={duration:K(Fe&&Fe.duration)})}var Xe=Fe&&Fe.title;le.caption=P.optional(Xe);le.photo=P.optional(ke);le.image360=P.optional(Le);le.video=P.optional(Ae);le.audio=P.optional(Oe);le.listItem=P.optional(Ce);_&&(le.parentKey=_);le.isDocSet=P.optional(Ne);ee.serverRelativeItemUrl===ee.serverRelativeListUrl&&(le.isRootFolder=!0);var Ve,$e=I.e.getItemName(d,se,Pe);le.name=P.optional($e);le.displayName=P.optional($e);var Je,Ke=!0;if(d.Modified&&"21"===this._pageContext.webTemplate&&Object(S.isFeatureEnabled)(S.RequestDatesInUtc))try{var Qe=new Date(d.Modified);le.dateModifiedTime=Qe;le.dateModifiedValue=Qe.getTime();Ve=Object(g.s)(Qe);Ke=!1}catch(e){}if(Ke){le.dateModifiedValue=P.optional(d.Modified);Ve=d["Modified.FriendlyDisplay"]?Object(y.e)(d["Modified.FriendlyDisplay"]):d.Modified?""+d.Modified:""}le.dateModified=P.optional(Ve||void 0);le.permissions=P.optional(de);if(R&&j&&j.length>0)if(V){R[0]||(R[0]=[]);var Ge=R[0]&&R[0].length>0?R[0][R[0].length-1]:null,Ye=j[0],Ze=j[1];if(Ye&&"1"===d[Ye+".newgroup"]){var et=Ge?Ge.startIndex+Ge.count:0,tt=q.e.buildGroup(Pe,d,Ye,0,!1,et),nt=this._convertToODNGroup(tt);R[0].push(nt);Ge=nt}if(Ze&&"1"===d[Ze+".newgroup"]){var rt=Ge&&Ge.children&&Ge.children.length>0?Ge.children[Ge.children.length-1]:null;et=rt?rt.startIndex+rt.count:Ge?Ge.startIndex:0;q.e.buildGroup(Pe,d,Ze,1,!1,et,Ge);var it=Ge.children.pop();Ge.children.push(this._convertToODNGroup(it))}}else for(var st=0;st<j.length;st++){var ot=j[st];if(ot){var ut=R[st]&&R[st].length>0?R[st][R[st].length-1]:null;if("1"===d[ot+".newgroup"]){et=ut?ut.startIndex+ut.count:0,nt=q.e.buildGroup(Pe,d,ot,st,!1,et);R[st]||(R[st]=[]);R[st].push(this._convertToODNGroup(nt))}}}if(U&&U.length>0&&d.ContentTypeId)for(var at=0,ft=U;at<ft.length;at++){var lt=ft[at];if(d.ContentTypeId===lt.contentTypeId){Je=!1;if(lt.requiredFields)for(var ct=0,ht=lt.requiredFields.split(",");ct<ht.length;ct++){var pt=d[ht[ct]];if(!pt||Array.isArray(pt)&&0===pt.length){Je=!0;break}}}}le.hasMissingMetadata=P.optional(Je);le.contentTypeId=P.optional(d.ContentTypeId);var dt,vt,mt,gt,yt,bt=d.folder,wt=[];if(bt){le.folder={};le.isDropEnabled=!0;dt=[];if(bt.children){for(var Et=0,St=bt.children,xt=St.length,Tt=0,Nt=0;Nt<xt;Nt++){var Ct=this.getItemResult({requestKey:M,queryType:B,itemFromServer:St[Nt],groupBy:j,itemGroups:wt,contentTypes:U,listTemplateType:Q,supportsNestedGroups:V,isItemDataOnly:$,observer:G,isMetaDataSearch:Y,pageContext:e.pageContext});if(Ct){dt[Nt]=Ct.item;Tt<10&&Ct.itemType===m.e.Media&&Et++;Tt++}}xt>0&&(Et>=10||Et>=xt)&&(le.displayType=u.e.Photos)}}else{mt=(mt=d["serverurl.progid"])?mt.substring(1):qe;Me[s.t.original]=mt;if(Object(S.isFeatureEnabled)(S.ShortcutLink)&&w.e.isShortcutItem({key:fe,extension:ne})){se=m.e.Shortcut;if(d._ShortcutUrl){le.shortcutInfo={shortcutLinkRewritten:!0};Me[s.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,d._ShortcutUrl,d._ShortcutSiteId,d._ShortcutWebId,d._ShortcutUniqueId);d._ShortcutUniqueId&&(vt=o.previewImageUrl({url:d._ShortcutUrl,siteId:d._ShortcutSiteId,webId:d._ShortcutWebId,uniqueId:d._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{le.shortcutInfo=P.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(fe,e.itemFromServer.ID);Me[s.t.shortcutTarget]=a.t.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+N.e.encodeURIComponent(d.FileRef)}}Me[s.t.open]=mt;gt=d["File_x0020_Type.mapapp"]||d["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];if(ee.isCrossDomain&&ee.isCrossList){var kt=d[".fileType"],Lt=x.u(kt||"");gt=void 0===Lt?kt?void 0:gt:Lt;"OneNote.Notebook"===d.HTML_x0020_File_x0020_Type&&(gt="onenote|UsePlain");"pdf"===d.File_x0020_Type&&(gt=void 0)}le.size=P.optional(He);le.totalSize=P.optional(Number(d.SMTotalSize)||void 0);vt||(vt=this._getThumbnail({itemFromServer:d,listTemplateType:Q,extension:ne,key:fe,type:se,mediaServiceFastMetadata:re,microServiceDataSource:L,pageContext:e.pageContext}));le.openUrl=mt;var At=d["IconOverlay.mapoly"];At&&(le.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+At);le.thumbnail=vt;var Ot=this._getPdfConversionFacet({extension:ne,blockDownload:me,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re});Ot&&(le.pdfConversion=Ot);var Mt=this._get3dFacet({extension:ne,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re});Mt&&(le.model3d=Mt);if(se===m.e.Folder){var _t=Number(d.ItemChildCount)+Number(d.FolderChildCount);le.childCount=_t;var Dt=Number(d.SMTotalFileCount);le.folder={totalCount:Dt>0?Dt:_t,childCount:_t};le.isDropEnabled=!0}var Pt=d.ServerRedirectedEmbedUrl;Pt&&(this._itemUrlHelper.getUrlParts({path:Pt}).isCrossDomain||(yt=Pt))}le.previewIFrameUrl=yt;le.type=se;le.appMap=P.optional(gt);this._pageContext.blockDownloadsExperienceEnabled&&(le.type===m.e.Media||mt&&gt)?le.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&se!==m.e.Folder?le.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(le.itemStatus=4);var Ht={};for(var Bt in d)d.hasOwnProperty(Bt)&&(Ht[Bt]=d[Bt]);var jt=C.e.normalizeLower(d.UniqueId)||void 0;jt&&(Ht.uniqueId=jt);var Ft=d.RemoteItem;le.remoteItem=Ft&&JSON.parse(Ft);le.reputationProperties=this.getReputationProperties(d);var It,qt=$e;ne&&(qt=$e.substring(0,$e.toLowerCase().lastIndexOf(ne.toLowerCase())));le.sharingRole=0;It=Number(d.PrincipalCount)>0?h.e.Shared:void 0===d.PrincipalCount?S.isOneDrive?void 0:h.e.Unknown:h.e.Private;le.sharingType=P.optional(It);Ht.FileName=qt;var Rt=l.n({extension:ne,isDocSet:Ne,listItem:Ce,sharingType:It,type:se,textEditorMimeType:je?"text/typescript":void 0,panorama:Le,isMountPoint:!!Ft});le.iconName=Rt;var Ut="ms-powerpoint"===gt,zt="ms-visio"===gt,Wt="ms-word"===gt;if(mt&&(Wt||"ms-excel"===gt||Ut||zt)){var Xt=this._getOfficeBundleFacet({isWord:Wt,extension:ne,itemUrlParts:ee,isPowerPoint:Ut,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re});!Xt||zt&&!this._allowWrsVisio||(le.officeBundle=Xt);Xt&&(Wt||Ut)&&(Me[s.t.viewInBrowser]=L.getPdfConversionUrl({fileExtension:ne,item:d,mediaServiceMetadata:re},!0));le.wopiFrameUrl=mt}le.defaultSubText=T.e(T.t(d.Editor));le.isPlaceholder=!d.PermMask;le.queryType=B;le.displayType=P.backup(le.queryType);le.isDraggable=le.queryType===u.e.Files;d.folder||(Ht.modifiedByUser=T.r(d.Editor));Ht.MediaServiceOCR=T.i(d.MediaServiceOCR);le.properties=Ht;le.lifeCycleStatus=P.optional(this._getItemLifeCycleStatus(d));le.comments={settings:W(d._CommentFlags)};le.urls=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Me),this._getVideoUrl({extension:ne,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re})),((p={})[s.t.mediaBaseUrl]=L.getMediaBaseUrl({fileExtension:ne,item:d,mediaServiceMetadata:re}),p));le.searchProperties={isMetadataSearch:Y};null==G||G.update([new D.e(fe).succeed({item:le})]);G&&Object(S.isFeatureEnabled)(S.ItemAnalytics)&&Object(S.isFeatureEnabled)(S.EnableTrendingSignalInListView)&&fe&&this.resources.consumeAsync(v).then(function(e){e.queueNewItem(fe)});var Vt=this._getGroupings({itemFromServer:d,supportsNestedGroups:V,groupBy:j,groups:wt}),$t=Vt.groupings,Jt=Vt.totalChildren;return{item:{key:fe},itemPatch:le,itemType:se,children:dt,groupings:$t,totalChildren:Jt,nextRequestToken:d.nextRequestToken}};t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;Object(S.isFeatureEnabled)(S.EnableATPFilesListView)&&0!==n&&3!==n&&(t.isMalwareDetected=!0);return t};t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,r=e.supportsNestedGroups,i=e.groupBy,s=e.groups,o=null,u=this._listContext.groupLevel,a=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==u)if(n.groups){var f=[],l=0;if(r){var c=q.e.buildCollapsedGroups(n.groups,this._listContext,i),h=c.groups,p=c.totalCount;f=h.map(function(e){return t._convertToODNGroup(e)});l=p}else for(var d=0,v=n.groups;d<v.length;d++){var m=v[d],g=i[u];if(m[g+".newgroup"]){var y=q.e.buildGroup(this._listContext,m,g,u,!0,l);f.push(this._convertToODNGroup(y));l+=y.count}}if(f&&f.length>0){o=[{name:void 0,itemGroups:f,isAllCollapsed:this.createObservable(!0)}];a=l}}else s&&s.length>0&&s[u]&&s[u].length>0&&(o=[{name:void 0,itemGroups:s[u],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:a}};t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,r=[],i=n.folder.children,s=n.nextRequestToken?2:0,o=i.length+s,u=0;u<o;u++){var a=i[u];if(a){if(!(this._getItemTypeOneNoteOrFolder(a)===m.e.Folder)){t=u;break}}}(void 0===t&&o>0||t>0)&&r.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&r.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return r.length?[{name:"FoldersDocumentsPhotos",itemGroups:r,isAllCollapsed:this.createObservable(!1)}]:void 0};t.prototype._getImage360=function(e,t,n,r){var i,s=t&&t.panorama,o=!1;if(s&&"equirectangular"===s.projectionType){i={projectionType:s.projectionType};o=!0}else e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0);if(o&&r){var u=r.panorama;if(u)i={projectionType:P.optional(s.projectionType||void 0),croppedAreaImageHeightPixels:P.optional(u.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:P.optional(u.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:P.optional(u.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:P.optional(u.croppedAreaTopPixels||void 0),fullPanoHeightPixels:P.optional(u.fullPanoHeightPixels||void 0),fullPanoWidthPixels:P.optional(u.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:P.optional(u.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:P.optional(u.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:P.optional(u.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:P.optional(u.initialViewPitchDegrees||void 0),initialViewRollDegrees:P.optional(u.initialViewRollDegrees||void 0),poseHeadingDegrees:P.optional(u.poseHeadingDegrees||void 0),posePitchDegrees:P.optional(u.posePitchDegrees||void 0),poseRollDegrees:P.optional(u.poseRollDegrees||void 0)};else{var a=r.photo;if(a&&a.cameraModel){var f=a.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro â€“ 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(f)>=0&&(i={projectionType:"equirectangular"})}}}return i};t.prototype.getReputationProperties=function(e){for(var t={},n=0,r=f;n<r.length;n++){var i=r[n];t[i]=P.optional(e[i])}return t};t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&V.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}};t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=U.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}};t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,r=e.itemUrlParts,i=e.isPowerPoint,s=e.itemFromServer,o=e.microServiceDataSource,u=e.mediaServiceFastMetadata,a=r.isCrossDomain;if(!a&&("21"===this._pageContext.webTemplate||Object(S.isFeatureEnabled)(S.EnableWrsPreviewOutsideODB))){var f,l,c,h=!a&&(t&&Object(S.isFeatureEnabled)(S.EnableWordWrsPreview)||i&&Object(S.isFeatureEnabled)(S.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:s,mediaServiceMetadata:u}):"",d=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:s,mediaServiceMetadata:u}),v=!1,m="",g=s[".ctag"],y=u&&u.officeBundle;if(y){f=y.ctag;c=y.version;v=y.fatalError||!1;y.generationTime&&(l=new Date(y.generationTime));m=y.errorInfo||""}return{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:d,bundleCTag:f,bundleVersion:c,hasBundleGenerationFailed:v,bundleErrorInfo:m,generationTime:l,cTag:g,enableDefaultClick:h}}};t.prototype._getThumbnail=function(e){if(e.type!==m.e.Folder){var t=e.itemFromServer;if(Object(k.o)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===k.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(A.e)(e.extension)){if(this._listContext.remoteParentWeb){var r=new a.t(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(a.e.authority),i=encodeURI(t.FileRef);return o.previewImageUrlFromUrl(N.e.encodeURIComponent(r+i),this._pageContext.webAbsoluteUrl,this._pageContext)}var s=e.pageContext;return $&&s&&s.webAbsoluteUrl&&s.siteId&&s.webId?o.previewImageUrlFromProps(s.siteId,s.webId,t.UniqueId,s.webAbsoluteUrl,s):o.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};t&&(n[s.t.video]=t);return n};t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,r=e.microServiceDataSource,i=e.mediaServiceFastMetadata,s=this._getItemTypeOneNoteOrFolder(t);if(s===m.e.Unknown){var o=t.File_x0020_Type,u=o?"."+o:"";if(Object(S.isFeatureEnabled)(S.ShortcutLink)&&w.e.isShortcutFileType(o))return m.e.Shortcut;if(Object(S.isFeatureEnabled)(S.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:u,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:r})))return m.e.Media;if(this._get3dFacet({itemFromServer:t,extension:u,microServiceDataSource:r,mediaServiceFastMetadata:i}))return m.e.Media;if("audio"===l.t(u))return m.e.Media;if(i)return m.e.Media;if((s=l.r(u))===m.e.Unknown)return Object(k.s)(n)?m.e.File:Object(k.o)(n)?m.e.Media:s}return s||m.e.File};t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=m.e.Folder;else if("1"===e.FSObjType||e.RemoteItem){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r=e["File_x0020_Type.mapapp"];t=r&&"onenote"===r.substring(0,7)||n&&-1!==n.indexOf("onenote")?m.e.OneNote:m.e.Folder}else t=m.e.Unknown;return t};t.prototype._convertToODNGroup=function(e){var t=this,n=e;n.state=this.createObservable({isCollapsed:e.isCollapsed});n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return n};t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;if("&"===e[1]){this._htmlDecodeDiv.innerHTML=e;t=this._htmlDecodeDiv.innerText}return JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{pageContext:O.h,urlDataSource:L.ve,listContext:O.o,navigation:_.e,microServiceDataSource:j.e,vroomUrlHelper:B.e,itemUrlHelper:H.o,vroomDataContext:M.e.optional,shortcutLinkDataSource:b.e});return t})(i.n);function K(e){return"number"==typeof e?e/1e4:e}var Q=Object(d.s)("ListItemBuilder",J)},3139:function(e,t,n){"use strict";n.d(t,"e",function(){return C});var r=n(151),i=n(26),s=n(82),o=n(1893),u=n(2019),a=n(55),f=n(164),l=n(216),c=n(2308),h=n(16),p=n(1154),d=n(308),v=n(1200),m=n(449),g=n(554),y=n(10),b=n(149),w=n(1205),E=n(15),S=n(3360),x=E.e.isActivated("1E9F2B0E-270E-4F40-9918-01DD9B46C5F0","7/2/2021","Use the page context from the list response for Web data"),T=!1;var N=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper}e.prototype.processResponse=function(e){var t=e.response,n=e.response,r=n.WebUrl,i=n.HttpRoot,s=n.ListData,o=n.rootFolder,a=n.ListSchema,f=(void 0===a?{}:a).Collapse,l=void 0===f?"FALSE":f,h=e.pageContext,p=e.requestKey,d=e.observer,v=this._urlDataSource.getKeyParams(p),m="TRUE"===l,g=this._itemUrlHelper.getItemUrlParts(p),y=this._itemUrlHelper.getUrlParts({path:g.serverRelativeListUrl,listUrl:g.fullListUrl});(r||i)&&this._processWeb({list:t,pageContext:h,requestKeyParts:v,observer:d});var b=this._processList({list:t,pageContext:h,listUrlParts:y,requestKeyParts:v,observer:d}).listRootItemKey,w=[];if(o){var E=this._processRootFolder({list:t,listUrlParts:y,requestKeyParts:v,observer:d});w.push.apply(w,E.parentItemUrls)}if(s&&!m){E=this._processListData({listData:s,listUrlParts:y,parentKey:p,requestKeyParts:v,observer:d});w.push.apply(w,E.parentItemUrls)}var S={};if(t.ParentInfo)for(var x=0,T=t.ParentInfo.ParentFolderInfo;x<T.length;x++){var N=T[x];S[N.ServerRelativeUrl]=c.t.fromHexString(N.Permissions)}for(var C=0,k=Object(u.e)(w);C<k.length;C++){var L=k[C];this._processParentItem({itemUrl:L,listUrlParts:y,parentInfo:S,requestKeyParts:v,observer:d})}return{listRootItemKey:b}};e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,r=e.requestKeyParts,i=e.listUrlParts,s=e.observer,u=[],a="",f=0,l=t;f<l.length;f++){var c=l[f],h=c.FileRef,p=this._processRow({row:c,observer:s,requestKeyParts:r,listUrlParts:i}).key;u.push.apply(u,this._getParentItemUrls({listUrlParts:i,itemUrl:h}));s.update([new o.e(p).succeed({set:{parent:{key:n},after:{key:a}}})]);a=p}return{parentItemUrls:u}};e.prototype._processRow=function(e){var t,n,r,s=e.row,u=e.row.FileRef,a=e.listUrlParts,l=e.requestKeyParts,c=e.observer,h=this._itemUrlHelper.getUrlParts({path:u,listUrl:a.fullListUrl});r=((t={}).id=h.serverRelativeItemUrl,t.listurl=h.normalizedListUrl,t);if(this._isFolder(s)){var p={},d=this._urlDataSource.getQueryType(l),v=l.typeFilters;d!==i.e.Search&&(p.view=l.view);v&&(p.typeFilters=v);f.e(r,p);l.searchid&&f.e(r,((n={}).searchid=l.searchid,n))}var m=this._urlDataSource.getKey(r),g=this._getParentKeyForListItem({listUrlParts:a,itemUrl:u,requestKeyParts:l}),y={key:m};g&&(y.parentKey=g);c.update([new o.e(m).succeed({item:y})]);return{key:m}};e.prototype._processRootFolder=function(e){var t,n,r,i=e.list,s=e.listUrlParts,u=e.requestKeyParts,a=e.observer,f=i.rootFolder,c=this._itemUrlHelper.getUrlParts({path:f,listUrl:s.fullListUrl}),h=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=u.view,t.q=u.q,t.typeFilters=u.typeFilters,t.searchid=u.searchid,t)),d=this._getParentKeyForListItem({listUrlParts:s,itemUrl:f,requestKeyParts:u}),v={key:h,type:l.e.Folder,newWOPIDocumentEnabled:p.optional(i.NewWOPIDocumentEnabled)};d&&(v.parentKey=d);if(i.ListData){n=i.ListData.FolderId;if("Sharepoint.DocumentSet"===i.ListData.CurrentFolderProgId){v.isDocSet=!0;if(i.AvailableContentTypes)for(var m=0,g=i.AvailableContentTypes;m<g.length;m++){var y=g[m],b=y.contentTypeId;if(b&&0===b.indexOf("0x0120D520")){v.contentTypeId=b;r=y.displayName;break}}}if(i.ListData.CurrentFolderSpItemUrl){var w=this._vroomUrlHelper.getUrlParts(i.ListData.CurrentFolderSpItemUrl);v.itemId=p.optional(w.itemId);v.graph={itemId:p.optional(w.itemId),driveId:p.optional(w.driveId)}}}r&&v.contentTypeId?v.properties={ID:p.optional(n),ContentType:r,ContentTypeId:v.contentTypeId}:v.properties={ID:p.optional(n)};if(!this._isListRoot({itemUrl:f,listUrlParts:s})){var E=f.split("/").slice(-1)[0];v.name=E;v.displayName=E}a.update([new o.e(h).succeed({item:v})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:s,itemUrl:f})}};e.prototype._processWeb=function(e){var t,n=e.list,r=e.requestKeyParts,s=e.observer,u=n.HttpRoot,a=n.SiteTitle,f=n.WebUrl||u&&m.i(decodeURIComponent(u)),c=this._itemUrlHelper.getUrlParts({path:f,webUrl:f}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=i.e.DocumentLibraries,t.typeFilters=r.typeFilters,t)),p={serverRelativeUrl:f},d={key:h,type:l.e.Folder,subsite:p},v=!x&&e.pageContext||this._pageContext.webAbsoluteUrl===f&&this._pageContext;if(v){d.name=a;d.displayName=a;p.webTemplateId=Number(v.webTemplate);p.serverRelativeUrl=v.webAbsoluteUrl;p.id=v.webId;p.siteCollectionId=v.siteId;p.title=v.webTitle;p.icon=v.webLogoUrl}s.update([new o.e(h).succeed({item:d})])};e.prototype._processList=function(e){var t,n,s,u,a,f=e.list,c=e.listUrlParts,d=e.requestKeyParts,v=e.observer,y=f.ListTitle,b=f.HttpRoot,E=f.ListUrl,S=f.listUrlDir,N=E||S&&decodeURIComponent(S),C=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=d.view,t.q=d.q,t.typeFilters=d.typeFilters,t.searchid=d.searchid,t)),k=f.AllowCreateFolder,L=f.EnableMinorVersions,A=f.verEnabled,O=f.AllowGridMode,M=f.DisableGridEditing,_=f.ListTemplateType,D=f.BasePermissions,P=void 0===D?{}:D,H=P.ManageLists,B=void 0===H?void 0:H,j=P.ManagePersonalViews,F=void 0===j?void 0:j,I=P.OpenItems,q=void 0===I?void 0:I,R=P.UseClientIntegration,U=void 0===R?void 0:R,z=f.ListSchema,W=void 0===z?{}:z,X=W.DefaultItemOpen,V=void 0===X?void 0:X,$=W[".driveAccessTokenV21"],J=void 0===$?void 0:$,K=W[".driveAccessToken"],Q=void 0===K?void 0:K,G=W[".driveUrl"],Y=void 0===G?void 0:G,Z=W[".driveUrlV21"],ee=void 0===Z?void 0:Z,te=f.ExcludeFromOfflineClient,ne=f.WebExcludeFromOfflineClient,re=f.listBaseType,ie=Q,se=J,oe=Y,ue=ee,ae=!x&&e.pageContext||N===this._pageContext.listUrl&&this._pageContext,fe=null==ae?void 0:ae.driveInfo;if(f.isFromServiceWorkerCache&&fe){fe[".driveAccessToken"]&&(ie=fe[".driveAccessToken"]);fe[".driveAccessTokenV21"]&&(se=fe[".driveAccessTokenV21"]);fe[".driveUrl"]&&(oe=fe[".driveUrl"]);fe[".driveUrlV21"]&&(ue=fe[".driveUrlV21"])}if(ie){s={accessToken:(le=Object(g.e)(ie)).access_token,proofToken:le.prooftoken,tokenUrl:oe}}if(se){var le;u={accessToken:(le=Object(g.e)(se)).access_token,proofToken:le.prooftoken,tokenUrl:ue}}var ce=f.WebUrl||b&&m.i(decodeURIComponent(b));if(ce){var he=this._itemUrlHelper.getUrlParts({path:ce,webUrl:ce});a=this._urlDataSource.getKey(((n={}).id=he.normalizedItemUrl,n.view=i.e.DocumentLibraries,n.typeFilters=d.typeFilters,n))}var pe="string"==typeof V?"0"===V:void 0;pe&&(function(){if(!T){r.e.logData({name:"List.openInClient"});T=!0}})();var de=oe&&this._vroomUrlHelper.getUrlParts(oe)||void 0;s&&Object(w.e)({authToken:s.accessToken,proofToken:s.proofToken})&&(s=void 0);u&&Object(w.e)({authToken:u.accessToken,proofToken:u.proofToken})&&(u=void 0);var ve="number"==typeof re?Object(h.r)(String(re)):void 0;v.update([new o.e(C).succeed({item:{key:C,parentKey:p.optional(a),itemId:p.backup("root"),graph:{itemId:p.backup("root"),driveId:p.optional((null==de?void 0:de.driveId)||void 0),sessionToken:p.optional(s),sessionTokenV21:p.optional(u)},type:l.e.Folder,name:p.optional(y),displayName:p.optional(y),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:p.optional(f.rootFolder?void 0:f.NewWOPIDocumentEnabled),list:{id:p.optional(f.listName),allowGridMode:"boolean"==typeof O?O:p.backup(!0),allowCreateFolder:p.optional(k),disableCommenting:"boolean"==typeof f.DisableCommenting&&f.DisableCommenting,disableGridEditing:"boolean"==typeof M?M:p.backup(!1),enableMinorVersions:p.optional(L),enableVersions:p.optional(A),templateType:p.optional("string"==typeof _?Number(_):void 0),isDocumentLibrary:p.optional(ve),isPromotedLinks:p.optional("string"==typeof _?Object(h.o)(_):void 0),isModerated:p.optional(f.isModerated),newWOPIDocumentEnabled:p.optional(f.NewWOPIDocumentEnabled),newWOPIDocumentTypes:p.optional(f.NewWOPIDocumentTypes),permissions:{manageLists:p.optional(B),managePersonalViews:p.optional(F),openItems:p.optional(q),useClientIntegration:p.optional(U)},openInClient:p.optional(pe),excludeFromOfflineClient:p.optional("boolean"==typeof te||"boolean"==typeof ne?te||ne:void 0),contentTypesEnabled:p.optional(f.ContentTypesEnabled),metadataNavFeatureEnabled:p.optional(f.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:p.optional(f.canUserCreateMicrosoftForm),itemCount:p.optional(f.ListSchema&&f.ListSchema.ItemCount),rowLimit:p.optional(f.ListData.RowLimit),listUrlDir:N,createdFromExcel:p.optional(f.CreatedFromExcel),createdFromExisting:p.optional(f.CreatedFromExisting)},properties:{commandsSupported:p.optional(f.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]);return{listRootItemKey:C}};e.prototype._processParentItem=function(e){var t,n=e.itemUrl,r=e.listUrlParts,i=e.parentInfo,s=e.requestKeyParts,u=e.observer,a=this._itemUrlHelper.getUrlParts({path:n,listUrl:r.fullListUrl}),f=this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.listurl=a.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t.searchid=s.searchid,t)),c={key:f,parentKey:this._getParentKeyForListItem({listUrlParts:r,itemUrl:n,requestKeyParts:s}),queryType:this._urlDataSource.getQueryType(s)};if(this._isListRoot({itemUrl:n,listUrlParts:r}))c.list={};else{var h=m.r(n);c.name=h;c.displayName=h;c.type=l.e.Folder;c.isDropEnabled=!0;c.folder={};i&&i[n]&&(c.permissions=i[n])}u.update([new o.e(f).succeed({item:c})])};e.prototype._getParentKeyForListItem=function(e){var t,n,r=e.listUrlParts,i=e.itemUrl,s=e.requestKeyParts;if(r.serverRelativeListUrl!==i){if(!E.e.isActivated("556c889b-eaaf-4e07-a746-6f7c7eee8553","8/18/2021","Show a more user-friendly error when the item does not have a FileRef field")&&!i)throw new Error(S.e);var o=i.split("/").slice(0,-1).join("/"),u=this._itemUrlHelper.getUrlParts({path:o,listUrl:r.fullListUrl});n=this._urlDataSource.getKey(((t={}).id=u.serverRelativeItemUrl,t.listurl=u.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t.searchid=s.searchid,t))}return n};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,r=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var s="",o=0,u=n.substring(i.length).split("/").slice(1,-1);o<u.length;o++){var a=""+i+(s+="/"+u[o]);r.push(a)}return r};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||r&&-1!==r.indexOf("onenote"))}else t=!1;return t};e.dependencies={urlDataSource:s.ve,pageContext:a.h,itemUrlHelper:d.o,vroomUrlHelper:v.e,resources:y.s};return e})(),C=Object(b.s)("ListItemResultProcessor",N)},3565:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(32);function i(e){return Object(r.isFeatureEnabled)(r.CSIMetadataSearch)&&!!e.canUserUseSyntex}},3566:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(1893),i=n(82),s=n(26),o=n(216),u=n(844),a=n(308),f=n(149),l=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._itemUrlHelper=t.itemUrlHelper}e.prototype.processSubsite=function(e){var t,n=e.subsite,i=e.requestKey,a=e.unique,f=e.observer,l=this._urlDataSource.getKeyParams(i),c=this._itemUrlHelper.getUrlParts({path:n.serverRelativeUrl,webUrl:n.serverRelativeUrl}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=s.e.DocumentLibraries,t.typeFilters=l.typeFilters,t.u=a,t)),p=Object(u.n)({type:o.e.Folder}),d={key:h,isRootFolder:!0,isPlaceholder:!1,name:n.title,displayName:n.title,type:o.e.Folder,iconName:p,subsite:n,queryType:s.e.DocumentLibraries};f.update([new r.e(h).succeed({item:d})]);return{key:h}};e.dependencies={urlDataSource:i.ve,itemUrlHelper:a.o};return e})(),c=Object(f.s)("SubsiteItemResultProcessor",l)},3567:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(10),i=n(149),s=new r.t({name:"RecycleBinDataSource.key",loader:new i.t(function(){return n.ee([324],3868).then(function(e){return e.resourceKey})})})},3690:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(853),s=n(351),o=n(1153),u=n(75),a=n(41),f=n(151),l=n(81),c=n(50),h=n(244),p={ODB:1201},d=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}t.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var o=t.remoteItem&&h.e.isFeatureEnabled(p)?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize);return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return o},"POST",this._getListRequestHeaders(t,n),void 0,void 0,t.noRedirect,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return u.n.reject(e)})};t.prototype.getUrl=function(e,t){var n,r=t&&t.postDataContext;n=h.e.isFeatureEnabled(p)?{webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId}:{webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};c.t.isActivated("03784CEA-7833-4740-8D6A-4EA05116664F","5/18/21","Set prefetch param")||(n.isPrefetchPageContext=e.listId&&!this._pageContext.listUrl);if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||r&&r.isOnePage)&&e.viewIdForRequest!==l.e.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}r&&r.groupReplace?n.requestToken=this._isExpandingGroup(n)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||r&&r.groupReplace||(n.groupString=e.group.groupString);r&&r.webId&&(n.webId=r.webId)}return i.t(n)};t.prototype.getAdditionalPostData=function(e,t,n){return s.e(e,t,n)};t.prototype.needsRequestDigest=function(e){return!!c.t.isActivated("4CE25DD5-0B47-4B9E-B6F9-5037A00C6CF8","04/21/2021","need Request Digest")||-1===e.toLowerCase().indexOf("/renderlistdataasstream?")};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getListRequestHeaders=function(e,t){var n=i.r(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};t.prototype._isExpandingGroup=function(e){return e.group&&"__next__"!==e.group.groupingId};t.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:a.e.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};t.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(r.__assign)({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else s=n.resultCode;n.resultCode=s;return{canRetry:i,eventData:n}}return{eventData:n}};t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?f.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&f.e.logData({name:e+".LookupColumnTreshold"})};return t})(o.t)},3816:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return De});var r=n(0),i=n(2472),s=n(2008),o=n(225),u=n(2183),a=n(2037),f=n(3697),l=n(232),c=n(26),h=n(384),p=n(636),d=n(653);var v=n(3565),m=n(216),g=n(16),y=n(1875),b=n(107),w=n(1076),E=n(30),S=n(82),x=n(55),T=n(310),N=n(149),C=n(75),k=n(78),L=n(32),A=n(246),O=n(81),M=n(171),_=n(1048),D=n(119),P=n(41),H=n(355),B=n(410),j=B.e,F=n(18),I=n(10),q=new I.t({name:"AuthTokenMonitor.key",loader:new N.t(function(){return n.ee([412],4343).then(function(e){return e.resourceKey})})}),R=n(3096),U=n(3139),z=n(3566),W=n(1943),X=n(1893),V=n(308),$=n(3690),J=n(351),K=new I.t({name:"PopularDataSource.key",loader:new N.t(function(){return n.ee([322],4344).then(function(e){return e.resourceKey})})}),Q=new I.t({name:"RecentDataSource.key",loader:new N.t(function(){return n.ee([323],4345).then(function(e){return e.resourceKey})})}),G=n(3567),Y=n(1306),Z=new I.t({name:"SiteDocumentLibrariesDataSource.key",loader:new N.t(function(){return n.ee([325],4526).then(function(e){return e.resourceKey})})}),ee=new I.t({name:"SubsiteItemDataSource.key",loader:new N.t(function(){return n.ee([327],4346).then(function(e){return e.resourceKey})})}),te=new I.t({name:"RemoteSiteService.key",loader:new N.t(function(){return n.ee([310],3786).then(function(e){return e.resourceKey})})}),ne=new I.t({name:"SharedItemDataSource.key",loader:new N.t(function(){return n.ee([653],4527).then(function(e){return e.resourceKey})})}),re=new I.t({name:"SharedItemDataSource.key",loader:new N.t(function(){return n.ee([644],4462).then(function(e){return e.resourceKey})})}),ie=new I.t({name:"ListItemsDataSourceDeferred.key",loader:new N.t(function(){return n.ee([320],4528).then(function(e){return e.resourceKey})})}),se=n(2806),oe=n(554),ue=n(1813),ae=n(115),fe=n(1123),le=n(2305),ce=n(452),he=n(95),pe=n(34),de=n(2005),ve=n(76),me=n(2158),ge=new I.t({name:"MruRecentListDataSource.key.mruRecentListDataSource",loader:new N.t(function(){return n.ee([321],4529).then(function(e){return e.resourceKey})})}),ye=n(1288),be=n(378),we=n(1156),Ee=n(35),Se=n(1876),xe=n(1198),Te=n(1188),Ne=n(576),Ce=n(1051),ke=n(453),Le=n(15),Ae=n(1053),Oe=new XMLSerializer,Me=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext,n)||this,i=new D.e({name:r.getDataSourceName()+".constructor"});Te.t.Init(r._pageContext);try{r._itemsStore=n.itemsStore;r.apiUrlHelper=n.apiUrlHelper;r.itemUrlHelper=n.itemUrlHelper;r.itemParentHelper=n.itemParentHelper;r._urlDataSource=n.urlDataSource;r._engagement=r.resources.consume(_.e);r._useFolderScopedSearch=r.resources.consume(se.t);r._alwaysRenderFilesTitle=r.resources.consume(se.e);r._microServiceDataSource=n.microServiceDataSource;r._microServiceDataSourceStore=n.microServiceDataSourceStore;r._listDataSource=n.listDataSource;r._listContext=n.listContext;r._itemsPerGroup=r.createObservable(-1);r.resources.isExposed(x.s)||r.resources.expose(x.s,r._itemsPerGroup);r.resources.isExposed(be.p)||r.resources.expose(be.p,!1);var s=[r._urlDataSource.getRootItemKey(c.e.Files),r._urlDataSource.getRootItemKey(c.e.Recent),r._urlDataSource.getRootItemKey(c.e.SharedWithMe),r._urlDataSource.getRootItemKey(c.e.RecycleBin)],o=new(r.resources.consume(W.resourceKey));o.update(s.map(function(e){return new X.e(e).succeed({item:{key:e,type:m.e.Folder,isRootFolder:!0}})}));o.flush();r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._subsiteItemResultProcessor=n.subsiteItemResultProcessor;n.identity&&(r._userIsAnonymous=n.identity.getIdentity().type===w.e.anonymous);r._spotlightDataSource=n.spotlightDataSource;r._onePageContext=n.onePageContext;r._contentTypes=n.contentTypes;i.end({resultType:P.e.Success})}catch(e){var u=void 0;u=e.message?e.message+" "+e.stack:"object"==typeof e?JSON.stringify(e):e;i.end({resultType:P.e.Failure,error:u})}return r}t.prototype.restoreAll=function(e){return null};t.prototype.createMountPoint=function(e){return null};t.prototype.removeMountPoint=function(e){return C.n.wrap(!1)};t.prototype.changeFolderType=function(e){return null};t.prototype.saveSortOrder=function(e){return null};t.prototype.addCoverPhotos=function(e){return null};t.prototype.removeCoverPhotos=function(e){return null};t.prototype.getOpenInClientDetails=function(e){return null};t.prototype.removeFromRecent=function(e){return C.n.wrap(!1)};t.prototype.rotateItems=function(e){return C.n.wrap()};t.prototype.updateBundle=function(e){return null};t.prototype.reportAbuse=function(e){return null};t.prototype.requestReview=function(e){return null};t.prototype.updateItemOcrInfo=function(e,t,n){return null};t.prototype.getItemOcrTextContent=function(e){var t=e.properties.MediaServiceOCR||"";return C.n.wrap(t)};t.prototype.updateItemProperty=function(e){return null};t.prototype.redeemPermissionToken=function(e){return C.n.wrap(null)};t.prototype.updateViewCount=function(e){return C.n.wrap(null)};t.prototype.processReferral=function(e,t){return null};t.prototype.getItem=function(e){function t(t){return t.then(function(t){return t.getItem(e)})}var n=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(n);e.qosName=e.qosName||"Odb."+c.e[r]+".ListItemsDataSource.getItem";switch(r){case c.e.RecycleBin:case c.e.SecondStageRecycleBin:return t(this._getRecycleBinDataSource());case c.e.Search:return this._useFolderScopedSearch?this._getItem(e):t(this._getSearchDataSource());case c.e.SearchOdbScope:return t(this._getSearchDataSource());case c.e.SharedWithMe:return t(this._pageContext.groupId?this._getSharedItemDataSource():this._getVroomSharedItemDataSource());case c.e.SharedByMe:case c.e.DocsInCommon:return t(this._getSharedItemDataSource());case c.e.Recent:return t(Number(this._pageContext.webTemplate)===b.e.mySite?C.n.resolve(this.resources.consumeAsync(ge.bypass)):C.n.resolve(this.resources.consumeAsync(Q.bypass)));case c.e.Popular:case c.e.RecentUnpopular:return t(C.n.resolve(this.resources.consumeAsync(K.bypass)));case c.e.DocumentLibraries:case c.e.DefaultDocLib:return t(C.n.resolve(this.resources.consumeAsync(Z.bypass)));case c.e.Subsites:return t(C.n.resolve(this.resources.consumeAsync(ee.bypass)));default:return this._getItem(e)}};t.prototype.getSpecifiedItems=function(e){var t=this,n={parentKey:e.parentKey||this._urlDataSource.getDefaultRootItemId(),itemKeys:e.itemKeys,recurseInFolders:e.recurseInFolders,getRootFolderFromParentKey:e.getRootFolderFromParentKey,viewId:null,needContentTypes:e.needContentTypes,itemSetKey:""},i=Object(r.__assign)({itemIds:null,recurseInFolders:!1,folderPath:null},this._listContext);this._listContext.itemIds=e.itemKeys;this._listContext.recurseInFolders=e.recurseInFolders;this._listContext.needSchema=!!e.needSchema;this._listContext.needForm=!!e.needForm;this._listContext.isGrouped=!1;this._listContext.group=null;this._listContext.groupBy=null;this._listContext.groupByOverride=null;this._listContext.groupLevel=null;this._listContext.groupSchema=null;this._listContext.isGrouped=!1;this._listContext.lastGroup=null;this._listContext.viewResult=null;this._listContext.viewIdForRequest=null;this._listContext.viewXmlForRequest=null;this._listContext.filterParams="";this._listContext.sortField=null;this._listContext.searchTerm=null;this._listContext.requestToken=null;n.parentKey&&(this._listContext.folderPath=this._getFolderPath(n.parentKey));var s=new D.e({name:this.getDataSourceName()+".GetSpecifiedItems"});return this._getItemInternal(n).then(function(e){e.children&&e.children[0]?s.end({resultType:P.e.Success}):s.end({resultType:P.e.Failure,resultCode:"ItemNotFound"});for(var n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];t._listContext[o]=i[o]}return e},function(e){s.end({resultType:P.e.Failure,resultCode:"ServerError",extraData:{error:e}});for(var n,r=0,o=Object.keys(t._listContext);r<o.length;r++){n=o[r];t._listContext[n]=null}for(var u=0,a=Object.keys(i);u<a.length;u++){n=a[u];t._listContext[n]=i[n]}return e})};t.prototype.getFilterData=function(e,t,n,r){if(this._urlDataSource.isCurrentQuery(c.e.SharedWithMe))return C.n.wrap();var i=this._urlDataSource.getCurrentItemKey(oe.e(t)),s=this._getFolderPath(i);return new le.e({parentKey:i,listContext:this._listContext,pageContext:this._pageContext,folderPath:s,itemUrlHelper:this.itemUrlHelper,apiUrlHelper:this.apiUrlHelper}).getFilterData(e,t,n,r)};t.prototype.createDocument=function(e,t,n,r){return this._getDeferredDataSource().then(function(i){return i.createDocument(e,t,n,r)})};t.prototype.createCustomDocument=function(e,t,n){return this._getDeferredDataSource().then(function(r){return r.createCustomDocument(e,t,n)})};t.prototype.createFolder=function(e){return this._getDeferredDataSource().then(function(t){return t.createFolder(e)})};t.prototype.deleteItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.deleteItems(e)})};t.prototype.moveItems=function(e){return this._getDeferredDataSource().then(function(t){return t.moveItems(e)})};t.prototype.copyItems=function(e){return this._getDeferredDataSource().then(function(t){return t.copyItems(e)})};t.prototype.getWorkProgress=function(e){return this._getDeferredDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.cancelWork=function(e){return this._getDeferredDataSource().then(function(t){return t.cancelWork(e)})};t.prototype.restoreItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.restoreItems(e)})};t.prototype.renameItem=function(e){return this._getDeferredDataSource().then(function(t){return t.renameItem(e)})};t.prototype.removeFromSharedList=function(e){return this._getDeferredDataSource().then(function(t){return t.removeFromSharedList(e)})};t.prototype.updateContentType=function(e,t,n){return this._getDeferredDataSource().then(function(r){return r.updateContentType(e,t,n)})};t.prototype.getDataSourceName=function(){return"ListItemDataSource"};t.prototype._isRequestingListViewData=function(e){return new RegExp("web/.*?/RenderListDataAsStream").test(e)};t.prototype._getPostDataContext=function(e){var t=!!this._listContext.needSchema||!this._listContext.listSchema||this._listContext.isGrouped&&!this._isExpandingGroup()||e.isGrouped,n=!!e.needContentTypes||!!this._listContext.needContentTypes;this._isFirstGroupOnlyQuery=!this._supportsNestedGroups&&0===this._listContext.groupLevel&&this._listContext.groupBy&&this._listContext.groupBy.length>1;var r=!1;if(e.parentKey&&this._spotlightDataSource&&!this._isSpecifiedItemRequest()){var i=this._listContext.viewIdForRequest;r=this._spotlightDataSource.shouldFetchSpotlight(e.parentKey,i,this._listContext)}var s=!!this._listContext.viewIdForRequest&&!this._listContext.viewResult,o=this._userIsAnonymous,u=this._fetchNextGroup(),a=e.additionalFiltersXml;if(u){var f=J.n(this._listContext.lastGroup);if(this._listContext.viewXmlForRequest){var l=ce.t(this._listContext.viewXmlForRequest);if(l&&l.where){var c=l.where.innerHTML?he.e([l.where.innerHTML,f]):f,h=F.format("<{0}>{1}</{0}>",pe.n.where,c),p=Oe.serializeToString(l.where);this._listContext.viewXmlForRequest=this._listContext.viewXmlForRequest.replace(p,h)}}else a=a?"<And>"+a+f+"</And>":f}var d=!(e.sortField||Number(this._pageContext.webTemplate)!==b.e.mySite||!this._pageContext.isSiteAdmin||this.itemUrlHelper.getItemUrlParts(e.parentKey).isCrossList),v=!this._listContext.needUpdatePageContext&&e.needClientSideComponentManifest,m=!!e.needsMountPoint;return{needsSchema:t,needsContentTypes:n,needsForms:!!this._listContext.needForm,needsQuickLaunch:!1,needsSpotlight:r,needsViewMetadata:s,needsParentInfo:o,viewXml:this._getViewXml(),firstGroupOnly:this._isFirstGroupOnlyQuery,expandGroups:this._expandGroup,allowMultipleValueFilterForTaxonomyFields:!!this._pageContext.isSPO||void 0,fieldNames:this._listContext.fieldNames,requestToken:this._listContext.requestToken,isListDataRenderOptionChangeFeatureEnabled:Object(L.isFeatureEnabled)(L.ListDataRenderOptionChange),isSpotlightFeatureEnabled:Object(L.isFeatureEnabled)(L.Spotlight),groupByOverride:this._listContext.groupByOverride,requestDatesInUtc:Number(this._pageContext.webTemplate)===b.e.mySite&&Object(L.isFeatureEnabled)(L.RequestDatesInUtc),needUpdatePageContext:!!this._listContext.needUpdatePageContext,needClientSideComponentManifest:v,groupReplace:!!this._groupReplace,additionalFiltersXml:a,webId:e.webId,siteId:e.siteId,mergeDefaultView:d,needsMountPoint:m}};t.prototype._processData=function(e,t,n){ae.n.mark("EUPL.ListItemDataSource.ProcessData.Start");var s,o=e.parentKey,u=n.ListData||n,a=u.Row,f=this._urlDataSource.getKeyParams(o),l=f.id,c=this._listContext.listSchema,p=n.ListContenTypes,d=this._onePageContext,v=d&&d.handleOnePageNavigationFallback,m=null;e.itemSetKey&&(s=this._itemsStore.getItemSet(e.itemSetKey));n.ListSchema&&(m=n.ListSchema.CustomFormatter);var y,b=n.NewExperienceRendering,w=void 0===b||b,E=n.ListSchema,S=n.ListData;if(!w&&v){v("modern UX is not supported");throw{code:"-4, onePageNavigationError"}}if(n.PageContextInfo)try{var x=JSON.parse(n.PageContextInfo);x.serverRequestPath=void 0;this._updatePageContextInfo(x);y=x}catch(e){}ue.e.updateListContext(n,this._listContext);if(E){var T={};c=this._listContext.listSchema=Object(i.t)({listSchema:E,resources:this.resources,groupSchema:T,hasFixedSchema:this._listContext.listTemplateType===g.t.mySiteDocumentLibrary,listContext:this._listContext,getItemContext:e,sortFallback:{sortField:S.SortField,sortDirection:S.SortDir}});E.group1&&(this._listContext.groupSchema=T)}else s&&s.schema&&s.schema.peek()&&(c=this._listContext.listSchema=s.schema.peek());n.Navigation&&(this._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});if(n.ViewMetadata&&d){var N=this._listContext.viewResult.serverRelativeUrl,C=this._listContext.viewResult.id,k=d.newTargetListViewUrl,A=d.newTargetListViewId;if(N&&k&&-1===k.toLowerCase().indexOf(N.toLowerCase())&&C&&A!==C&&v){v("view does not match");throw{code:"-4, onePageNavigationError"}}d.newTargetListViewId=d.newTargetListViewUrl=void 0}var M=E&&"TRUE"===E.Collapse,_=!M&&a?a.slice(0):[];l&&l!==this._urlDataSource.getDefaultRootItemId()||(l=this._listContext.listUrl);var D="";u.NextHref&&(D=(D=u.NextHref).replace("&View="+O.e.Empty,""));var P=new(this.resources.consume(W.resourceKey));this._processResponse({response:n,pageContext:y,observer:P,requestKey:o});this.resources.consumeAsync(q.optional).then(function(e){e&&e.trackListToken(o)});var H,B={id:f.id,folder:{childCount:_.length,children:_},nextRequestToken:D,PermMask:u.FolderPermissions,groups:M?a:null,isRootFolder:!1};if(Object(Ne.n)()){var j=n&&n.ListData&&n.ListData.CurrentFolderProgId;B.ProgId=j}if(Object(h.e)(t)){var F=void 0;if(!Le.e.isActivated("920cd1f9-9369-4d43-9e22-7acf0b6bc647","7/29/2021","Add scenario to doclib search result"))if(Object(Ee.d)(f)){F="MetadataSearch";H=!0}else{F="DoclibSearch";H=!1}this._engagement.logData({name:"Search.InpageNumResults",scenario:F,extraData:{count:_.length}})}var I=null;if(this._listContext.groupByOverride)I=[this._listContext.groupByOverride];else if(this._listContext.rawListSchema&&this._listContext.rawListSchema.group1){(I=[]).push(this._listContext.rawListSchema.group1);this._listContext.rawListSchema.group2&&I.push(this._listContext.rawListSchema.group2);this._isFirstGroupOnlyQuery||(this._listContext.groupBy=I)}this._listContext.groupLevel=this._getGroupLevel();this._listContext.isGrouped=!!I;1===e.groupingType&&(I=["__ItemType"]);this._contentTypes&&(p?this._contentTypes(p):p=this._contentTypes.peek());if(c&&p){for(var R={},U=0,z=c;U<z.length;U++){var X=z[U];R[X.internalName]=Object(r.__assign)(Object(r.__assign)({},X),{requiredForContentTypes:{}})}for(var V=0,$=p;V<$.length;V++){if(re=(ne=$[V]).requiredFields&&ne.requiredFields.split(","))for(var J=0,K=re;J<K.length;J++){var Q=K[J];R[Q]&&(R[Q].requiredForContentTypes[ne.contentTypeId]=!0)}}c=c.map(function(e){return R[e.internalName]})}if(p&&p.length>0){for(var G={},Y={},Z={},ee=0,te=p;ee<te.length;ee++){var ne,re=(ne=te[ee]).requiredFields&&ne.requiredFields.split(","),ie=ne.requiredLookups&&ne.requiredLookups.split(",");G[ne.contentTypeId]=re;if(re)for(var se=0;se<re.length;se++){var oe=re[se];Y[oe]||(Y[oe]=!0);Z[oe]=ie&&"True"===ie[se]}}this._listContext.contentTypeRequiredFields=G;this._listContext.requiredFieldsAreLookups=Z;this._listContext.requiredFields=Object.keys(Y);this._listContext.needContentTypes=!1}var fe=this._listItemBuilder.getItemResult({requestKey:o,queryType:t,itemFromServer:B,groupBy:I,itemGroups:null,contentTypes:p,supportsNestedGroups:this._supportsNestedGroups,observer:P,isMetaDataSearch:H}),le=fe.children,ce=fe.item,he=fe.groupings,pe=fe.totalChildren;this._processListTitleOverride({response:n,listUrl:this._getListUrl(o),requestKey:o,observer:P});e.skipStoreResults||P.flush();Object(L.isFeatureEnabled)(L.Spotlight)&&this._cacheSpotlightItemsFromServerData({requestKey:o,parentItem:this._itemsStore.getItem(o),queryType:t,spdata:n});var de,ve,me=this._itemsStore.getItem(ce.key);if(le){de=[];for(var ge=0,ye=le;ge<ye.length;ge++){var be=ye[ge];de.push(this.peekUnwrapObservable(this._itemsStore.getItem(be.key)))}}if(he&&he[0]){var we=he[0].itemGroups,Se=we[we.length-1];Se.fieldSchema&&this._listContext.groupSchema[Se.fieldSchema.Name]&&(this._listContext.lastGroup=Se)}for(var xe=0,Te=c;xe<Te.length;xe++){if((X=Te[xe]).internalName===this._listContext.sortField){ve=X.key;break}}var Ce={item:this.peekUnwrapObservable(me),groupings:he,children:de,totalChildren:pe,schema:c,contentTypes:p,nextRequestToken:D,sortField:ve,isAscending:"true"===this._listContext.isAscending,customViewRenderer:m,viewId:this._listContext.viewResult?this._listContext.viewResult.id:void 0};this._listContext.group?Ce.startIndex=this._listContext.group.startIndex:u.FirstRow&&(Ce.startIndex=u.FirstRow-1);n.isFromServiceWorkerCache?Ce.isFromBrowserCache=!0:Ce.isFromBrowserCache=!1;ae.n.mark("EUPL.ListItemDataSource.ProcessData.End");return Ce};t.prototype._processResponse=function(e){var t,n,r=e.response,i=e.pageContext,s=e.requestKey,o=e.observer,u=this.itemUrlHelper.getItemUrlParts(s);if(_e(r)){t=r;n=r.ListSchema}else t={ListData:r};var a=this._listItemResultProcessor.processResponse({response:t,pageContext:i,requestKey:s,observer:o}).listRootItemKey;if(n){var f={data:n,allowCookies:this._isOneDrive(u.normalizedListUrl)};this._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(a).setBaseInfo(f);this._microServiceDataSource.setBaseInfo(f)}};t.prototype._updatePageContextInfo=function(e){this.updateContext(e);this._defaultListUrl=e.listUrl};t.prototype._getFolderPath=function(e,t){var n=this._urlDataSource.getKeyParams(e).id;return n&&n!==this._urlDataSource.getDefaultRootItemId()?n:null};t.prototype._getListUrl=function(e){var t=this._urlDataSource.getKeyParams(e),n=t&&t.listurl;n||(n=this._listContext.listUrl);return n};t.prototype._isOneDrive=function(e){return!this.itemUrlHelper.getItemUrlParts(e).isCrossList&&this._listContext.listTemplateType===g.t.mySiteDocumentLibrary};t.prototype._processListTitleOverride=function(e){var t,n,i=e.response,s=e.requestKey,o=e.observer;n=_e(i)?i:{ListData:i};var u,l,h=this._urlDataSource.getKeyParams(s),p=h.q,d=this.itemUrlHelper.getItemUrlParts(s),v=this.itemUrlHelper.getUrlParts({path:d.serverRelativeListUrl,listUrl:d.fullListUrl}),m=n.ListTemplateType;if(this._urlDataSource.isCurrentQuery(c.e.Search,h)&&p){Object(L.isFeatureEnabled)(L.CSISpoScopeControl)||1===Object(A.n)(90097,this._pageContext)||(u=F.format(f.e,p));l=c.e.Search}else(this._alwaysRenderFilesTitle||Number(m)===g.t.mySiteDocumentLibrary)&&(u=a.a);if(u){var y=this._urlDataSource.getKey(((t={}).id=v.serverRelativeItemUrl,t.listurl=v.normalizedListUrl,t.view=h.view,t.q=h.q,t.typeFilters=h.typeFilters,t));o.update([new X.e(y).succeed({item:Object(r.__assign)({key:y,name:u,displayName:u},void 0!==l?{queryType:l}:{})})])}};t.prototype._setContext=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),r=e.newTargetListUrl||n.listurl||this._defaultListUrl,i=this._urlDataSource.getItemTypeFilter(n);this._supportsNestedGroups=e.supportsNestedGroups;this._expandGroup=e.expandGroup;this._groupReplace=e.groupReplace;var s=e.baseViewId,o=e.viewXml,u=e.filters,a=void 0===u?{}:u,f=e.sortField,l=e.isAscending,c=e.requestToken,h=e.needSchema,p=e.pageSize,d=void 0===p?30:p,m=e.parentKey,g=e.groupBy,y=e.group,b=e.query,w=e.queryType,E=e.needUpdatePageContext,S=e.resultSetOptions,x=(void 0===S?{}:S).fieldNames,T=void 0===x?[]:x,N=e.viewPath;r&&(this._listContext.listUrl=r);this._listContext.filterParams=Object.keys(a||{}).map(function(e){return"&"+e+"="+k.e.encodeURIComponent(a[e])}).join("");if(Object(v.e)(this._pageContext)){var C=(function(e){var t=e.searchid;if(t){var n=sessionStorage.getItem(t);if(n){return JSON.parse(n)}}})(n);C&&(b=b?b+" "+C.kql:C.kql)}this._listContext.itemIds=null;this._listContext.requestToken=c;this._listContext.needSchema=!!h;this._listContext.pageSize=d;this._listContext.folderPath=this._getFolderPath(m,e);this._listContext.groupByOverride=g;this._listContext.groupLevel=this._getGroupLevel();this._listContext.group=y;this._listContext.searchTerm=b;this._listContext.queryType=w;this._listContext.typeFilter=i;this._listContext.fieldNames=T;var L=this._urlDataSource.getKeyParams(m);!L.listurl&&e.newTargetListUrl&&(L.listurl=e.newTargetListUrl);var A=this._urlDataSource.getKey(L);this._listContext.urlParts=this.itemUrlHelper.getItemUrlParts(A);this._listContext.needUpdatePageContext=!!E;!this._listContext.refreshClientForm&&this._listContext.needUpdatePageContext&&(this._listContext.refreshClientForm=!0);try{var O=JSON.stringify({defaultFullWebUrl:this._pageContext.webAbsoluteUrl,defaultListUrl:this._pageContext.listUrl,keyParts:n});fe.e.logData({name:"ListItemsDataSource._setContext",message:O})}catch(e){}return this._loadRemoteParentWeb({parentKey:m,remoteWebUrl:e.remoteWebUrl}).then(function(){return t._loadView({fieldNames:T,typeFilter:i,baseViewId:s,viewXml:o,viewPath:N,listFullUrl:t._listContext.urlParts.fullListUrl})}).then(function(){if(f){t._listContext.sortField=f;t._listContext.isAscending=!1===l?"false":"true"}else if(t._isUsingView()){t._listContext.sortField=null;t._listContext.isAscending=null}})};t.prototype._loadRemoteParentWeb=function(e){var t,n=this,r=e.parentKey,i=e.remoteWebUrl;delete this._listContext.remoteParentWeb;var s=this.itemUrlHelper.getItemUrlParts(r),o=s.fullListUrl;if(i){var u=new URL(i).origin;o=u+s.serverRelativeListUrl}s.isCrossList&&s.siteRelation!==V.t.sameSite&&(t=C.n.resolve(this.resources.consumeAsync(te.bypass)).then(function(e){return e.getSiteForList(o,s.siteRelation)}).then(function(e){n._listContext.remoteParentWeb=e;var t=new(n.resources.consume(W.resourceKey));n._subsiteItemResultProcessor.processSubsite({subsite:e,requestKey:r,observer:t});t.flush()},function(e){}));return C.n.as(t).then(function(){})};t.prototype._loadView=function(e){var t,n=this,r=e.fieldNames,i=e.typeFilter,s=e.baseViewId,o=e.viewXml,u=e.viewPath,a=e.listFullUrl;this._setViewIdAndPath(s,u);var f=r.filter(function(e){return"name.FileSystemItemId"!==e});(i.filters.length||f.length)&&s&&!o&&(t=this._listDataSource.getView({id:s},a).then(function(e){o=e.getEffectiveViewXml();n._listContext.viewResult=e}));return C.n.as(t).then(function(){n._listContext.viewXmlForRequest=o})};t.prototype._getViewXml=function(){var e=this._listContext,t=e.fieldNames,n=void 0===t?[]:t,i=e.typeFilter,s=void 0===i?{filters:[]}:i,o=e.viewXmlForRequest,u=e.sortField,a=e.isAscending,f=e.groupByOverride;if(!u&&!this._isUsingView()&&!this._isTeamSiteLike()){u="LinkFilename";a="true"}var c=n.filter(function(e){return"name.FileSystemItemId"!==e}),h="";if(this._isSpecifiedItemRequest()||!this._isUsingView())h=J.i({sortField:u,itemIds:this._listContext.itemIds,isAscending:a,pageSize:this._listContext.pageSize,fetchNextGroup:void 0,lastGroup:this._listContext.lastGroup,recurseInFolders:this._listContext.recurseInFolders,fieldNames:c,typeFilter:s,groupBy:this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,userIsAnonymous:this._userIsAnonymous,requestMetaInfo:Object(L.isFeatureEnabled)(L.EnablePowerPointWrsPreview)||Object(L.isFeatureEnabled)(L.EnableWordWrsPreview),requestCommentFlags:!0});else if(o)if(u||f||s.filters.length||c.length){var p=new l.e(o);u&&p.updateSort(null,{overwriteAll:!0});f&&p.updateGroupBy({isCollapsed:!1,group1:{fieldName:f}});s.filters.length&&p.addFilters([J.r(s)]);c.length&&p.replaceFields(Object(r.__spreadArrays)(p.getEffectiveFieldNames(),c));h=p.getEffectiveViewXml()}else h=this._listContext.viewXmlForRequest;return h};t.prototype._getItem=function(e){var t=this,n=this.itemUrlHelper.getItemUrlParts(e.parentKey),r=this.peekUnwrapObservable(this._itemsStore.getItem(e.parentKey));if(e.newTargetListUrl||e.requestToken||r&&r.type===m.e.Folder||n.fullItemUrl===n.fullListUrl||r&&r.remoteItem||e.remoteItem||e.isMountPointFolder)return this._getAsFolder(e);if(r&&(r.type===m.e.File||r.type===m.e.Media||r.type===m.e.Unknown||r.type===m.e.Shortcut)||e.ignoreChildren){ae.n.mark("EUPL.OneUP.GetSingleItem.Start");return this._getSingleItem(e)}return this._getAsFolder(e).then(function(n){var r=t.peekUnwrapObservable(t._itemsStore.getItem(n.item.key));if(!E.e.hasPermission(r.permissions,E.e.openItems)&&!n.totalChildren){ae.n.mark("EUPL.NoOneUP.GetSingleItem.Start");return t._getSingleItem(e).then(function(e){var r=n&&t.peekUnwrapObservable(t._itemsStore.getItem(n.item.key));return r&&r.type!==m.e.Folder?e:n})}t._listContext.listTemplateType===g.t.mySiteDocumentLibrary&&t._getSingleItem(e).done();return n})};t.prototype._getAsFolder=function(e){var t=this,n=this._listContext;e.ignoreListContext&&(this._listContext={});return this._setContext(e).then(function(){return t._getItemInternal(e).then(function(r){e.ignoreListContext&&(t._listContext=n);return r})})};t.prototype._getRemoteItemUrl=function(e){return e.SiteUrl+"/_api/web/Lists/GetById(@a1)/RenderListDataAsStream?@a1="+e.ListId+"&RootFolderUniqueId=$"+e.UniqueId};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getSingleItem=function(e){var t,n=this,i=this.itemUrlHelper.getItemUrlParts(e.parentKey),s=new $.e({pageContext:this._pageContext}),o=this.itemUrlHelper.getUrlParts({path:i.serverRelativeListUrl,listUrl:i.fullListUrl}),a=this._urlDataSource.getKey(((t={}).id=o.serverRelativeItemUrl,t.listurl=o.normalizedListUrl,t)),f=J.i({sortField:void 0,itemIds:void 0,itemRefs:[i.serverRelativeItemUrl],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0,pageSize:1}),l=new D.e({name:"GetSingleItem"}),h={viewXml:f,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:Object(L.isFeatureEnabled)(L.ListDataRenderOptionChange)},p={urlParts:o},d=e.remoteItem?this._getRemoteItemUrl(e.remoteItem):s.getUrl(p,e),v=e.remoteItem?this._getRemoteItemPostData():s.getAdditionalPostData(h);return this._tryGetPrefetchedListViewData({url:d,parseResponse:function(e){var t=e.listData;return JSON.parse(t)},qosName:"GetSingleItemFromPrefetchedData",qos:l,additionalPostData:v,fallbackGetData:function(){var t={parentKey:a,postDataContext:h,skipServiceWorkerCache:!1,remoteItem:e.remoteItem,authToken:e.authToken,siteUrl:e.remoteWebUrl};e.skipCache&&(t.skipServiceWorkerCache=!0);var n={qosEvent:l,qosName:"GetData"};return s.getItem(t,p,n)}}).then(function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i,s,o,f,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:n=new(this.resources.consume(W.resourceKey));this._processResponse({response:t,pageContext:void 0,requestKey:a,observer:n});i=t.ListData.Row;if(s=!i.length&&this._getError(-2147024894))return[3,1];o=(function(e){var t=e.ListTemplateType,n=Number(t);return isNaN(n)?void 0:n})(t);for(f=0,h=i;f<h.length;f++){p=h[f];this._listItemBuilder.getItemResult({requestKey:a,queryType:c.e.Files,itemFromServer:p,listTemplateType:o,supportsNestedGroups:!1,observer:n})}return[3,4];case 1:return Object(L.isFeatureEnabled)(L.ShowRequestAccessButton)?[4,this._getAccessUrl(e.parentKey)]:[3,3];case 2:(d=v.sent())&&(s=Object(r.__assign)(Object(r.__assign)({},s),{actionText:u.p,actionUrl:d}));v.label=3;case 3:n.update([new X.e(e.parentKey).succeed({item:{key:e.parentKey,type:m.e.Error,error:{type:2,data:s},isPlaceholder:!1}})]);v.label=4;case 4:this._processListTitleOverride({response:t,listUrl:this._getListUrl(a),requestKey:a,observer:n});n.flush();l.end({resultType:P.e.Success});return s?[2,C.n.wrapError(s)]:[2,{item:{key:e.parentKey},children:[],totalChildren:0}]}})})},function(t){var r=t?"string"==typeof t.code?t.code.split(","):t.error.code.split(","):[],i=r.length>1?Number(r[0]):-1,s=n._getError(i,void 0,t),o=new(n.resources.consume(W.resourceKey));o.update([new X.e(e.parentKey).succeed({item:{key:e.parentKey,type:m.e.Error,isPlaceholder:!1,error:{type:2,data:s}}})]);o.flush();return C.n.wrapError(s)})};t.prototype._getAccessUrl=function(e){var t=this,n=window.location.href,i="/shares/u!"+window.btoa(n).replace("=","").replace("+","-").replace("/","_")+"/root",s=this.resources.consume(Ae.e);return this.resources.consumeAsync(S.b).then(function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=this._itemsStore.getItem(e);return[4,n.refreshAccessToken(t.peek(),{forceRefresh:!0})];case 1:o=r.sent();return[2,s.send({apiName:"shares",apiVersion:Object(L.isFeatureEnabled)(L.MediaTAUseVroomV21)?"v2.1":"v2.0",path:i,requestType:"GET",useAuthorizationHeaders:!0,accessToken:o}).then(function(){return null}).catch(function(e){return e.response.error&&e.response.error["@error.fixItUrl"]})]}})})})};t.prototype._isUsingView=function(){return!(!this._listContext.viewXmlForRequest&&!this._listContext.viewIdForRequest)};t.prototype._isTeamSiteLike=function(){return Object(b.n)(this._pageContext.webTemplate)};t.prototype._getItemInternal=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),i=this._urlDataSource.getQueryType(n),s=new D.e({name:"GetPrefetchedListViewData"}),o=new $.e({pageContext:this._pageContext}),u=i===c.e.Files,a=Object(h.e)(i),f=this._getPostDataContext(e),l=function(e){e.resultCode&&(e.resultCode="GetData."+e.resultCode);switch(e.resultType){case P.e.ExpectedFailure:xe.t(e);break;case P.e.Failure:xe.r(e)}},p=function(){var u=Object(r.__assign)({},e);u.postDataContext=t._getPostDataContext(e);e.skipCache&&(u.skipServiceWorkerCache=!0);var f=a?"SearchGetData":"GetData";!Le.e.isActivated("0ba26f89-4680-4c43-9e5f-557b73a6d534","9/29/2021","QoS name for metadata search")&&a&&Object(v.e)(t._pageContext)&&t._urlDataSource.getMetadataSearchId&&t._urlDataSource.getMetadataSearchId(n)&&(f="MetadataSearchGetData");var c={qosEvent:s,qosName:f};return o.getItem(u,t._listContext,c,l).then(function(n){return t._handleDataProcessing(n,i,e)})},d=o.getUrl(this._listContext,e);return(u&&this._isRequestingListViewData(d)?this._tryGetPrefetchedListViewData({url:d,parseResponse:function(n){var r,i=n.listData;try{"string"==typeof i&&(r=JSON.parse(i))}catch(e){if("{}"!==i.substring(0,2)){s.end({resultType:P.e.Failure,resultCode:"BadJSON",extraData:{responseText:i,prefetch:"true"}});throw e}r=JSON.parse(i.substring(2))}return t._handleDataProcessing(r,e.queryType,e)},qosName:"GetItemFromPrefetchedData",qos:s,additionalPostData:o.getAdditionalPostData(f),fallbackGetData:p}):p()).then(function(e){return e},function(e){if(void 0===e.code&&void 0===e.error)return C.n.wrapError(e);var n="string"==typeof e.code?e.code.split(","):e.error.code.split(","),r=n.length>1?Number(n[0]):-1;return C.n.wrapError(t._getError(r,void 0,e))})};t.prototype._tryGetPrefetchedListViewData=function(e){var t=this;0;ae.n.mark("EUPL.GetPrefetch.Start");var n=e.url,r=e.qos,i=e.fallbackGetData,s=e.additionalPostData,u=o.e.createHashCode(n,s);window.ListDataActualHash=u;var a=o.e.prefetchData(u);if(!a){if(o.e.shouldLogError){var f=-1===n.indexOf("?")?null:oe.e(n.substring(n.indexOf("?")+1));r.end({resultType:P.e.Failure,resultCode:"PrefetchNotStartedOrUrlOrPayLoadNotMatch",extraData:{AdditionalPostData:s||"null",QueryStrings:f?Object.getOwnPropertyNames(f):"null"}});o.e.shouldLogError=!1}0;return i()}o.e.shouldLogError=!1;var l=function(){var e=o.e.createHashCode("ListContenTypes","ListContenTypes"),n=o.e.prefetchData(e);n&&n.listData?t._contentTypes&&t._contentTypes(n.listData):a&&(a.contentTypesCallback=l)};l();var c=function(t,f){var l=function(l,c){if(200===l||c){r.end({resultType:P.e.Success});var h=ae.n.getResponseEnd();if(l&&!c){ae.n.summary.dataFetchServerTime=a.serverDuration;if(window.performance&&performance.timing){ae.n.summary.prefetchStart=a.startTimeMark-h;window.g_prefetchStart=ae.n.summary.prefetchStart}var p=B.r.getRUMOneLogger();if(p){var d=a.correlationId,v=new j(n,a.serverDuration,d,l,null,(new Date).toISOString());p.writeAPICallPerformanceData(v)}ae.n.mark("EUPL.Prefetch.End")}else if(c){if(window.g_deferDataLoadTime&&window.performance&&performance.timing){ae.n.summary.deferredListDataRender=Number(window.g_deferDataLoadTime)-h;window.g_deferredListDataRender=ae.n.summary.deferredListDataRender}ae.n.mark("EUPL.DeferredListData.End")}try{var m=e.parseResponse(a);t(m)}catch(e){f(e)}}else{(403===l?{resultType:P.e.ExpectedFailure,resultCode:"PrefetchUnauthorized"}:{resultType:P.e.Failure,resultCode:"PrefetchFailed"}).extraData={AdditionalPostData:s||"null",ResponseStatusCode:l};0;i().then(t,f)}o.e.clearPrefetchData(u)};a.responseCode||a.deferredListData?l(a.responseCode,a.deferredListData):a.completedCallback=l};return H.e.instrumentPromise({url:n,name:this.getDataSourceName()+"."+e.qosName},function(){return new C.n(c)},null,function(e){return e&&"Canceled"===e.name?{error:e,resultCode:"Canceled",resultType:P.e.ExpectedFailure}:{error:e,resultType:P.e.Failure}})};t.prototype._setViewIdAndPath=function(e,t){if(e){e=O.e.normalizeLower(e,!1);this._listContext.viewIdForRequest=e;this._listContext.viewResult&&this._listContext.viewResult.id!==e&&(this._listContext.viewResult=null)}e&&e!==O.e.Empty||!t||(this._listContext.viewPathForRequest=t)};t.prototype._getError=function(e,t,n){var r=n&&n.correlationId,i={ItemNotFoundTitle:u.l,ItemNotFoundSubText:u.f,InvalidViewTitle:u.a,InvalidViewSubText:u.u,InvalidListTitle:u.o,InvalidListSubText:u.s,QueryThrottledSubText:u.h,QueryThrottledLinkText:u.c,FailedOfflineTitle:u.i,FailedOfflineSubText:u.r,DefaultTitle:u.n,DefaultSubText:u.t};-2147024860===e&&this._engagement.logData({name:"listView.Throttled",extraData:{correlationId:n.correlationId}});return Object(ye.e)(e,i,r)};t.prototype._fetchNextGroup=function(){return this._listContext.isGrouped&&this._listContext.group&&"__next__"===this._listContext.group.groupingId&&!(this._groupReplace&&this._listContext.lastGroup&&this._listContext.lastGroup.count<this._itemsPerGroup.peek())&&!this._isSpecifiedItemRequest()};t.prototype._isSpecifiedItemRequest=function(){return this._listContext.itemIds&&this._listContext.itemIds.length>0};t.prototype._isExpandingGroup=function(){return this._listContext.group&&"__next__"!==this._listContext.group.groupingId};t.prototype._getGroupLevel=function(){var e=-1,t=this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,n=this._listContext.rawListSchema&&"TRUE"===this._listContext.rawListSchema.Collapse;if(t&&t.length>0){e=0;if(this._supportsNestedGroups){if(this._listContext.filterParams&&!n){var r=(i=M.default.getFilterFieldByName(this._listContext.filterParams,t[0]))&&t[1]&&M.default.getFilterFieldByName(this._listContext.filterParams,t[1]);(i&&1===t.length||r&&2===t.length)&&(e=-1)}}else if(this._listContext.filterParams){var i;if(i=M.default.getFilterFieldByName(this._listContext.filterParams,t[0])){e=(r=M.default.getFilterFieldByName(this._listContext.filterParams,t[1]))&&!n?-1:1}}}return e};t.prototype._cacheSpotlightItemsFromServerData=function(e){var t=e.requestKey,n=e.parentItem,r=e.queryType,i=e.spdata;if(this._spotlightDataSource&&i.SpotlightInfo&&this._listContext.viewIdForRequest&&n&&n.peek()&&n.peek().key){var s=[],o=this._spotlightDataSource;if(i.SpotlightInfo.Items&&i.SpotlightInfo.Items.Row&&i.SpotlightInfo.Order&&i.SpotlightInfo.Order.length){for(var u=i.SpotlightInfo.Items.Row,a=i.SpotlightInfo.Order,f=new(this.resources.consume(W.resourceKey)),l=[],c=0,h=u;c<h.length;c++){var p=h[c];l.push(this._listItemBuilder.getItemResult({requestKey:t,queryType:r,itemFromServer:p,groupBy:null,itemGroups:null,contentTypes:[],supportsNestedGroups:this._supportsNestedGroups,observer:f}).item)}f.flush();for(var d={},v=0,m=l;v<m.length;v++){var g=m[v].key;(w=this._itemsStore.getItem(g))&&(d[w.peek().properties.ID]=w)}for(var y=0,b=a;y<b.length;y++){var w;(w=d[b[y]])&&s.push(w)}}var E=this._listContext.viewIdForRequest===O.e.Empty?this._listContext.viewResult.id:this._listContext.viewIdForRequest;o.cacheSpotlightItems(n,E,s)}};t.prototype._getDeferredDataSource=function(){return C.n.resolve(this.resources.consumeAsync(ie))};t.prototype._getSearchDataSource=function(){return C.n.resolve(this.resources.consumeAsync(Y.e.bypass))};t.prototype._getSharedItemDataSource=function(){return C.n.resolve(this.resources.consumeAsync(re.bypass))};t.prototype._getVroomSharedItemDataSource=function(){return Object(ke.r)()?this._getSharedItemDataSource():C.n.resolve(this.resources.consumeAsync(ne.bypass))};t.prototype._getRecycleBinDataSource=function(){return C.n.resolve(this.resources.consumeAsync(G.e.bypass))};t.prototype._handleDataProcessing=function(e,t,n){var r=this;n.remoteItem&&(n.parentKey=e&&e.rootFolder?e.rootFolder:n.parentKey);var i,s=n.parentKey,o=e.ShouldLoadSPFramework,u=void 0!==o&&o,a=this._onePageContext&&this._onePageContext.handleOnePageNavigationFallback,f=!1;if(u){if(e.SPFrameworkClientInfo){this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(de.e));i=this._clientSideExtensionHelper.loadSPFrameworkForOnePageNavigation(e.SPFrameworkClientInfo)}else f=!0;if(f&&a){a("SPFramework");throw{code:"-4, onePageNavigationError"}}}var l=function(e){r._engagement.logData({name:"List."+e});e="EUPL."+e+".LoadModule.";ae.n.mark(e+"Start")},c=function(){var i=r._loadClientSideCustomizer(e,n.parentKey),o=r._getCustomFormatterModule(e);if(o||i){if(o&&i){l("MultipleCustomizers");return C.n.all([i,o]).then(function(e){var i=e[0],o=e[1],u=i;window.CustomFormatter=o.CustomFormatter;return r._onCustomLoadersEnd(n,u,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}if(o){l("CustomFormatter");return o.then(function(i){window.CustomFormatter=i.CustomFormatter;return r._onCustomLoadersEnd(n,e,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}l("ClientSideCustomizer");return i.then(function(e){return r._onCustomLoadersEnd(n,e,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}return r._processData(n,t,e)};return i?i.then(function(){return c()}).catch(function(e){a("SPFramework");throw{code:"-4, onePageNavigationError"}}):c()};t.prototype._onCustomLoadersEnd=function(e,t,n,r,i){ae.n.mark(i+"End");return this._processData(e,n,t)};t.prototype._getCustomFormatterModule=function(e){if(e&&e.ListSchema&&e.ListSchema.Field){for(var t=e.ListSchema.Field,r=!1,i=0;i<t.length;i++){var s=t[i];if(s.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterField."+s.FieldType,extraData:{templateId:this._getTemplateIdFromFormatter(s.CustomFormatter)}})}}if(e.ListSchema.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterViewLoad",extraData:{templateId:this._getTemplateIdFromFormatter(e.ListSchema.CustomFormatter)}})}if(r){this._engagement.logData({name:"CustomFormatterLoad"});return C.n.resolve(n.ee(19,3785)).then(Ce.e)}}return null};t.prototype._getTemplateIdFromFormatter=function(e){try{var t=JSON.parse(e);if(t.templateId)return t.templateId}catch(e){}};t.prototype._loadClientSideCustomizer=function(e,t){var n,r=this,i=this._engagement;if(e.ListSchema)n=e.ListSchema.Field;else{var s=this._listContext.listSchema;n=s&&s.map(function(e){return{RealFieldName:e.realFieldName||e.internalName,ID:e.id,Type:e.serverFieldType,DisplayName:e.name,Name:e.name,ClientSideComponentId:e.clientSideComponentId,ClientSideComponentProperties:e.clientSideComponentProperties}})}if(n&&!(n.length<1)){if(this._prepareClientSideCustomizedFields(e,n)){var o=new D.e({name:"LoadFieldCustomizers"});ae.n.mark("EUPL.LoadFieldCustomizers.Start");this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(de.e));if(!this._clientSideExtensionHelper){console.log("Error on consuming ClientSideExtensionHelper");o.end({resultType:P.e.Failure,resultCode:"ConsumeClientSideExtensionHelperFailed"});ae.n.mark("EUPL.LoadFieldCustomizers.NoClientSideExtensionHelper.End");return C.n.wrap(e)}if(!window.moduleLoaderPromise){i.logData({name:"LoadSpfx.moduleLoaderPromiseNotFound",extraData:{SpModuleLoaderExists:!!window.spModuleLoader}});console.log("sp-client module loader promise does not exist")}return this._clientSideExtensionHelper.getListViewAdapter().then(function(t){try{if(!t){console.log("sp-client listViewHostApp failed to create listViewAdapter");o.end({resultType:P.e.Failure,resultCode:"FailToCreateListViewAdapter"});ae.n.mark("EUPL.LoadFieldCustomizers.Error.FailListViewAdapter.End");return e}ae.n.mark("EUPL.LoadFieldCustomizers.GotListViewAdapter");n.forEach(function(e,n,r){try{var i={id:e.ID,internalName:e.RealFieldName||e.Name,fieldType:e.FieldType,isRequired:!!e.Required&&"TRUE"===e.Required.toUpperCase(),isVisible:!0,displayName:e.DisplayName,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(t){console.log("Fail to load customizer for column: "+e.Name+", componentId: "+e.ClientSideComponentId+", error: "+t.message)}},s=t.addColumnAdapter(i);if(!s)throw"addColumnAdapter returns null";if(i.clientSideComponentId&&i.clientSideComponentId!==O.e.Empty){e.ClientSideColumnAdapter=s;console.log("Add Spfx column adapter for "+e.RealFieldName)}}catch(t){console.log("Error on addColumnAdapter for column: "+e.Name+", error: "+t)}});return t.loadFieldCustomizers().then(function(t){console.log("fieldCustomizers loaded");o.end({resultType:P.e.Success});ae.n.mark("EUPL.LoadFieldCustomizers.End");r._logLoadFieldCustomizersResult(e);return e},function(t){console.log("fieldCustomizers failed to load, error: "+t);o.end({resultType:P.e.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersPromiseError",error:t});ae.n.mark("EUPL.LoadFieldCustomizers.PromiseError.End");return e})}catch(t){o.end({resultType:P.e.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersCatch",error:t});ae.n.mark("EUPL.LoadFieldCustomizers.Error.End");return e}})}return null}i.logData({name:"LoadSpfx.ListFieldsNotAvailable"})};t.prototype._logLoadFieldCustomizersResult=function(e){(e.ListSchema?e.ListSchema.Field:[]).forEach(function(e,t,n){if(e.ClientSideComponentId&&e.ClientSideColumnAdapter){var r="EUPL.LoadFieldCustomizers."+e.ClientSideComponentId+".";r+=e.ClientSideColumnAdapter.fieldCustomizerLoaded?"Loaded":"Failed";ae.n.mark(r)}})};t.prototype._prepareClientSideCustomizedFields=function(e,t){var n,r={},i=new ve.t(document.location.href),s=i.getQueryParameter("fieldCustomizers");try{if(n=JSON.parse(s))for(var o in n){var u=n[o],a="",f="";if("string"==typeof u)a=u;else if("object"==typeof u){u.id&&(a=u.id);if(u.properties){var l="";"object"==typeof u.properties&&(l=JSON.stringify(u.properties));f=l}}r[o]={internalName:o,clientSideComponentId:a,clientSideComponentProperties:f}}}catch(e){console.log("Error when parse query parameter: fieldCustomizers, error: "+e)}for(var c=!1,h=!1,p=0,d=t;p<d.length;p++){var v=d[p],m=v.RealFieldName,g=void 0;r.hasOwnProperty(m)&&(g=r[m]);if(g&&!v.CustomFormatter){v.ClientSideComponentId=g.clientSideComponentId;v.ClientSideComponentProperties=g.clientSideComponentProperties;c=!0}v.ClientSideComponentId&&v.ClientSideComponentId!==O.e.Empty&&!v.CustomFormatter&&(h=!0)}if(!h&&c){i.getQueryParameter("loadSPFX")||console.log("WARNING! SPFX is required to be loaded. Add 'loadSPFX=true' query parameter")}return c||h};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.e.dependencies),{itemsStore:y.t,pageContext:x.h,listContext:x.o,apiUrlHelper:we.e,itemUrlHelper:V.o,itemParentHelper:Se.e,urlDataSource:S.ve,microServiceDataSource:p.e,microServiceDataSourceStore:d.e,listDataSource:me.resourceKey,listItemBuilder:R.e,listItemResultProcessor:U.e,subsiteItemResultProcessor:z.e,rumOneHelper:T.e,identity:S.S.optional,spotlightDataSource:S.fe.optional,onePageContext:x.c.optional,contentTypes:x.n.optional});return t})(s.e);t.default=Me;function _e(e){return!!e.ListData}var De=Object(N.s)("ListItemsDataSource",Me)}}]);