(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[166],{1864:function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n(1852),s=n(10),o=n(149),u={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},a={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},f=new s.t({name:"ResponsiveUI.breakpoints",factory:new s.e(a)}),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._containerElement=t.containerElement||window;var i=r.observables;r._breakpoints=i.wrap(n.breakpoints);r.events.on(r._containerElement,"resize, orientationchange",r._onContainerResize);r.windowWidth=i.create(0);r.windowHeight=i.create(0);r.formFactorSize=i.pureCompute(r._computeFormFactorSize);r.isHamburgerVisible=i.pureCompute(r._computeIsHamburgerVisible);r.showLabels=i.pureCompute(r._computeShowLabels);r.cssClass=i.pureCompute(r._computeCssClass);r._onContainerResize();return r}t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};t.determineWindowSize=function(e,t){void 0===t&&(t=a);if(0===e)return"Medium";for(var n in a)if(e<t[n])return n};t.determineCssClass=function(e){return u[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,r=document.documentElement,i=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,s=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i);this.windowHeight(s)};t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"};t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())};t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0};t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<a.Large};t.dependencies={breakpoints:f};t.DEFAULT_BREAKPOINTS=a;t.MAC_SCROLL_BAR_WIDTH=8;return t})(i.n);t.e=l;var c=Object(o.s)("ResponsiveUI",l)},3834:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2083),s=n(1881),o=n(1865),u=n(75),a=n(128),f=n(41),l=n(1886),c=n(136);Object(c.n)([{rawString:".od-MalwareDetected-dialog-header{color:"},{theme:"errorText",defaultValue:"#a4262c"},{rawString:";font-size:21px;margin-bottom:15px}"}]);var h=n(1854),p=n(18),d=n(3056),v='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">'+d.r+"</a>",m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.allowInfectedDownload=t.allowInfectedDownload;n.malwareDetectedIconUrl=window.require.toUrl("odsp-media/images/atp/malware_icon_168x168.svg");n.malwareDetectedMessageHeader=d.t;n.malwareDetectedMessage=p.format(d.n,v);n.malwareDetectedAllowDownloadMessage=p.format(d.e,v);return n}return t})(h.t),g=n(1855).e({tagName:"od-malwareDetected",template:'<div class="od-MalwareDetected-dialog-content"><div class="od-MalwareDetected-dialog-header" data-bind="text:malwareDetectedMessageHeader"></div><div>\x3c!--ko if:allowInfectedDownload--\x3e<span data-bind="html:malwareDetectedAllowDownloadMessage"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:allowInfectedDownload--\x3e<span data-bind="html:malwareDetectedMessage"></span>\x3c!--/ko--\x3e</div></div>',viewModel:m}),y=n(308),b=n(1864),w=n(55),E=n(112),S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="malwareDetected";n.dialogProvider=n.resources.consume(l.e);n._itemSelectionHelper=new(n.child(s.e))({overrideItem:t.item});n._responsiveUI=n.resources.consume(b.t);n._pageContext=n.resources.consume(w.h);n._navigation=n.resources.consume(E.e);n._itemUrlHelper=n.resources.consume(y.o);return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype.onExecute=function(e,t){this._getMalwareDetectedDialog();return u.n.wrap({resultType:f.e.Failure})};t.prototype._getMalwareDetectedDialog=function(){var e=this,t=this._pageContext.allowInfectedDownload,n=[];t&&n.push({name:a.Download,execute:function(){e._downloadInfectedItemViaClassic();return u.n.wrap(2)},isAvailable:this.observables.create(!0),icon:new o.e("Download"),isDefault:!0});n.push({name:t?a.declineInfectedDownload:a.ok,execute:function(){return u.n.wrap(2)},isAvailable:this.observables.create(!0),icon:new o.e("Cancel"),isDefault:!0});this.dialogProvider.requestDialog({component:{name:g.tagName,params:{allowInfectedDownload:t}},size:"Medium",actions:n,focusOnPrimaryAction:!0,isDismissable:!(this._responsiveUI.compareSize(this._responsiveUI.formFactorSize(),"Small")<=0)})};t.prototype._getItemClassicDownloadLink=function(){var e=this._itemSelectionHelper.firstItem();return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl+"?avcmd=1"};t.prototype._downloadInfectedItemViaClassic=function(){var e=this._getItemClassicDownloadLink();e&&this._navigation.navigateTo({url:e,frameId:"_blank"})};return t})(i.e);t.default=S}}]);